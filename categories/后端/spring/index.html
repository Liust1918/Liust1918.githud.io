<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>分类: spring - Liust of Blog</title><link rel="manifest" href="/Liust1918.githud.io/manifest.json"><meta name="application-name" content="Liust of Blog"><meta name="msapplication-TileImage" content="/img/Battlerfiled3.jpg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Liust of Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Liust of Blog"><meta property="og:url" content="https://liust1918.github.io/Liust1918.githud.io"><meta property="og:site_name" content="Liust of Blog"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://liust1918.github.io/Liust1918.githud.io/img/og_image.png"><meta property="article:author" content="Liust"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://liust1918.github.io/Liust1918.githud.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://liust1918.github.io/Liust1918.githud.io"},"headline":"Liust of Blog","image":["https://liust1918.github.io/Liust1918.githud.io/img/og_image.png"],"author":{"@type":"Person","name":"Liust"},"publisher":{"@type":"Organization","name":"Liust of Blog","logo":{"@type":"ImageObject","url":"https://liust1918.github.io/img/Battlerfiled3.jpg"}},"description":""}</script><link rel="icon" href="/Liust1918.githud.io/img/Battlerfiled3.jpg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/Liust1918.githud.io/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><script data-ad-client="liust" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }
          Array
              .from(document.querySelectorAll('.tab-content'))
              .forEach($tab => {
                  $tab.classList.add('is-hidden');
              });
          Array
              .from(document.querySelectorAll('.tabs li'))
              .forEach($tab => {
                  $tab.classList.remove('is-active');
              });
          const $activeTab = document.querySelector(location.hash);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
          const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/Liust1918.githud.io/"><img src="/Liust1918.githud.io/img/Battlerfiled3.jpg" alt="Liust of Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/Liust1918.githud.io/">主页(Home)</a><a class="navbar-item" href="/Liust1918.githud.io/archives">文章(Archives)</a><a class="navbar-item" href="/Liust1918.githud.io/categories">类型(Categories)</a><a class="navbar-item" href="/Liust1918.githud.io/tags">标签(Tags)</a><a class="navbar-item" href="/Liust1918.githud.io/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="My GitHub" href="https://github.com/Liust1918"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/Liust1918.githud.io/categories">分类</a></li><li><a href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/">后端</a></li><li class="is-active"><a href="#" aria-current="page">spring</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-12-03T15:54:28.000Z" title="2022/12/3 23:54:28">2022-12-03</time>发表</span><span class="level-item"><time dateTime="2022-12-03T16:37:29.468Z" title="2022/12/4 00:37:29">2022-12-04</time>更新</span><span class="level-item"><a class="link-muted" href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/">后端</a><span> / </span><a class="link-muted" href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/spring/">spring</a></span><span class="level-item">1 小时读完 (大约13232个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Liust1918.githud.io/2022/12/03/Spring%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/">Spring实战(第5版)</a></h1><div class="content"><h2 id="Spring实战-第5版-书-弃用"><a href="#Spring实战-第5版-书-弃用" class="headerlink" title="Spring实战(第5版)书(弃用)"></a>Spring实战(第5版)书(弃用)</h2></div><a class="article-more button is-small is-size-7" href="/Liust1918.githud.io/2022/12/03/Spring%E5%AE%9E%E6%88%98-%E7%AC%AC5%E7%89%88/#more">阅读更多</a></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-12-03T15:48:27.000Z" title="2022/12/3 23:48:27">2022-12-03</time>发表</span><span class="level-item"><time dateTime="2023-03-10T14:42:13.165Z" title="2023/3/10 22:42:13">2023-03-10</time>更新</span><span class="level-item"><a class="link-muted" href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/">后端</a><span> / </span><a class="link-muted" href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/spring/">spring</a></span><span class="level-item">1 小时读完 (大约11675个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/Liust1918.githud.io/2022/12/03/%E9%87%8D%E5%AD%A6SpirngBoot2-X/">重学SpirngBoot2.X</a></h1><div class="content"><span id="more"></span>


<h1 id="什么是SpringBoot"><a href="#什么是SpringBoot" class="headerlink" title="什么是SpringBoot"></a>什么是SpringBoot</h1><h3 id="特性"><a href="#特性" class="headerlink" title="特性"></a>特性</h3><ul>
<li>约定大于配置：配置简化,不用像传统SSM的配置地狱</li>
<li>无需关心依赖版本：springboot已经测试好各种依赖关系最好的版本，无需自己考虑依赖版本.</li>
</ul>
<h3 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h3><ul>
<li>快速并且简易的开发：不用很多配置</li>
<li>未来的SpringCloud是以SpringBoot为基础</li>
</ul>
<h3 id="使用IDEA构建简单SpringBoot项目"><a href="#使用IDEA构建简单SpringBoot项目" class="headerlink" title="使用IDEA构建简单SpringBoot项目"></a>使用IDEA构建简单SpringBoot项目</h3><p>file-&gt;new-&gt;project-&gt;Spring Initializr修改内容-&gt;选择需要的依赖-&gt;finish</p>
<h1 id="项目结构和导出"><a href="#项目结构和导出" class="headerlink" title="项目结构和导出"></a>项目结构和导出</h1><h2 id="结构"><a href="#结构" class="headerlink" title="结构"></a>结构</h2><ul>
<li>src：项目主要结构<ul>
<li>java：java源代码<ul>
<li>主启动类：XXXApplication</li>
</ul>
</li>
<li>resources：<ul>
<li>static：静态文件</li>
<li>templates：模板引擎存放</li>
<li>application.properties：配置文件</li>
</ul>
</li>
</ul>
</li>
<li>target：项目编译后文件</li>
<li>pom.xml：项目描述和依赖</li>
</ul>
<p><strong>注意：源代码必须在主启动类的同一或者以下的文件目录</strong></p>
<h2 id="maven项目导出"><a href="#maven项目导出" class="headerlink" title="maven项目导出"></a>maven项目导出</h2><p>利用maven导出</p>
<ul>
<li><p>打开IDEA右边的Maven</p>
</li>
<li><p>使用package打包</p>
<p><img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-18_212127-16425122068871.png" alt="屏幕截图 2022-01-18 212127"></p>
</li>
<li><p>在Run中出现BUILD SUCCESS</p>
</li>
<li><p>在target文件中找到.jar文件</p>
</li>
</ul>
<h2 id="项目运行-win平台"><a href="#项目运行-win平台" class="headerlink" title="项目运行(win平台)"></a>项目运行(win平台)</h2><ul>
<li>获得.jar文件</li>
<li>cmd运行指令：java -jar 项目名.jar</li>
<li>不关闭窗体就一直运行</li>
</ul>
<h1 id="SpringBoot主启动类"><a href="#SpringBoot主启动类" class="headerlink" title="SpringBoot主启动类"></a>SpringBoot主启动类</h1><h5 id="启动类"><a href="#启动类" class="headerlink" title="启动类"></a>启动类</h5><p>XXXXApplication.class</p>
<h2 id="SpringBootApplication注解"><a href="#SpringBootApplication注解" class="headerlink" title="@SpringBootApplication注解"></a>@SpringBootApplication注解</h2><h3 id="用途-1"><a href="#用途-1" class="headerlink" title="用途"></a>用途</h3><ul>
<li><strong>自动初始化Spirng IOC容器</strong></li>
<li><strong>扫描并实例化Bean</strong></li>
<li><strong>自动配置组件参数</strong></li>
</ul>
<h3 id="其中包含三个子注解"><a href="#其中包含三个子注解" class="headerlink" title="其中包含三个子注解"></a>其中包含三个子注解</h3><h4 id="SpringBootConfiguration"><a href="#SpringBootConfiguration" class="headerlink" title="@SpringBootConfiguration"></a>@SpringBootConfiguration</h4><p>类似加载配置文件的效果,一般还会使用java类型的配置文件：</p>
<ul>
<li>类级别：@Configuration</li>
<li>方法级别：@Bean<ul>
<li>实例名：方法名</li>
<li>实例类：返回方法</li>
</ul>
</li>
</ul>
<h4 id="EnableAutoConfiguration"><a href="#EnableAutoConfiguration" class="headerlink" title="@EnableAutoConfiguration"></a>@EnableAutoConfiguration</h4><p>自动配置.</p>
<h4 id="ComponentScan"><a href="#ComponentScan" class="headerlink" title="@ComponentScan"></a>@ComponentScan</h4><p>扫描并实例化组件.</p>
<ul>
<li>@Controller——控制层</li>
<li>@Serivce——服务层</li>
<li>@Repository——持久化层</li>
<li>@Component——组件类</li>
</ul>
<h1 id="SpringBoot的Controller层"><a href="#SpringBoot的Controller层" class="headerlink" title="SpringBoot的Controller层"></a>SpringBoot的Controller层</h1><h2 id="用途-2"><a href="#用途-2" class="headerlink" title="用途"></a>用途</h2><ul>
<li>接收前端数据</li>
<li>处理业务逻辑</li>
<li>返回响应数据</li>
</ul>
<h2 id="返回响应数据"><a href="#返回响应数据" class="headerlink" title="返回响应数据"></a>返回响应数据</h2><h3 id="页面跳转"><a href="#页面跳转" class="headerlink" title="页面跳转"></a>页面跳转</h3><ul>
<li>类设置 <strong>@Controller</strong></li>
<li>创建<strong>ModelAndView对象</strong><ul>
<li>参数为：跳转页面</li>
<li>可以调用方法输入响应参数</li>
</ul>
</li>
<li><strong>方法返回值ModelAndView</strong></li>
</ul>
<p>以此为例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestMyModeAndViewController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//点击此连接</span></span><br><span class="line">    <span class="comment">//将会跳转到 mytest.ftl的freemark模板</span></span><br><span class="line">    <span class="comment">//并且添加数据 key-value=msg &quot;后台数据&quot;</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/toTestPage&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ModelAndView <span class="title function_">toTestPage</span><span class="params">(ModelAndView modelAndView)</span> &#123;</span><br><span class="line">        modelAndView.setViewName(<span class="string">&quot;mytest&quot;</span>);</span><br><span class="line">        modelAndView.addObject(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;后台传数据&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> modelAndView;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="返回JSON序列化"><a href="#返回JSON序列化" class="headerlink" title="返回JSON序列化"></a>返回JSON序列化</h3><p>Jackson是SpringBoot默认的JSON序列化组件</p>
<h4 id="Controller-ResponseBody"><a href="#Controller-ResponseBody" class="headerlink" title="@Controller+@ResponseBody"></a>@Controller+@ResponseBody</h4><ul>
<li>返回对象值（对象值会被jackson序列化）</li>
</ul>
<h4 id="RestController"><a href="#RestController" class="headerlink" title="@RestController"></a>@RestController</h4><p>相当于添加类级别@Controller，该类下面的所有方法都是默认添加@ResponseBody.</p>
<ul>
<li>返回对象值(对象会被jackson序列化)</li>
</ul>
<h2 id="接收前端数据"><a href="#接收前端数据" class="headerlink" title="接收前端数据"></a>接收前端数据</h2><h3 id="GetMapping"><a href="#GetMapping" class="headerlink" title="GetMapping"></a>GetMapping</h3><h4 id="路径变量-PathVariable"><a href="#路径变量-PathVariable" class="headerlink" title="路径变量@PathVariable"></a>路径变量@PathVariable</h4><ul>
<li>修改路径</li>
<li>添加 <strong>@PathVariable</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(path = &quot;/&#123;group&#125;/&#123;uid&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map <span class="title function_">findUser</span><span class="params">(<span class="meta">@PathVariable(&quot;group&quot;)</span>String group,<span class="meta">@PathVariable(&quot;uid&quot;)</span>String uid)</span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;group&quot;</span>, group);</span><br><span class="line">    map.put(<span class="string">&quot;uid&quot;</span>, uid);</span><br><span class="line">    <span class="keyword">return</span> map;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="表单提交和-RequestParam"><a href="#表单提交和-RequestParam" class="headerlink" title="表单提交和@RequestParam"></a>表单提交和@RequestParam</h4><h5 id="表单提交"><a href="#表单提交" class="headerlink" title="表单提交"></a>表单提交</h5><ul>
<li>表单类型：表单名</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value = &quot;/page1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map <span class="title function_">page1</span><span class="params">(<span class="type">int</span> page,<span class="type">int</span> rows)</span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;page&quot;</span>, page);</span><br><span class="line">    map.put(<span class="string">&quot;rows&quot;</span>, rows);</span><br><span class="line">    <span class="keyword">return</span> map;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="添加-RequestParam"><a href="#添加-RequestParam" class="headerlink" title="添加@RequestParam"></a>添加@RequestParam</h5><ul>
<li><strong>@RequestParam(defaultValue&#x3D;默认值,name&#x3D;表单名)</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value = &quot;/page2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map <span class="title function_">page2</span><span class="params">(</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(defaultValue = &quot;1&quot;,name = &quot;p&quot;)</span><span class="type">int</span> page,</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(defaultValue = &quot;10&quot;,name = &quot;r&quot;)</span><span class="type">int</span> rows</span></span><br><span class="line"><span class="params">)</span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;page&quot;</span>, page);</span><br><span class="line">    map.put(<span class="string">&quot;rows&quot;</span>, rows);</span><br><span class="line">    <span class="keyword">return</span> map;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="获取http头信息-RequestHeader"><a href="#获取http头信息-RequestHeader" class="headerlink" title="获取http头信息@RequestHeader"></a>获取http头信息@RequestHeader</h4><p>添加header信息</p>
<ul>
<li><strong>@RequestHeader（”key值”）</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value = &quot;/get_header&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map <span class="title function_">getHeader</span><span class="params">(<span class="meta">@RequestHeader(&quot;token&quot;)</span>String accessToken,String id)</span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;access_token&quot;</span>, accessToken);</span><br><span class="line">    map.put(<span class="string">&quot;id&quot;</span>, id);</span><br><span class="line">    <span class="keyword">return</span> map;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="调用原生HttpServletRequest"><a href="#调用原生HttpServletRequest" class="headerlink" title="调用原生HttpServletRequest"></a>调用原生HttpServletRequest</h4><p>不推荐使用，程序和Servlet容器会强耦合</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value = &quot;/raw_request&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map <span class="title function_">testRequest</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;id&quot;</span>, request.getParameter(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">    <span class="keyword">return</span> map;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="PostMapping"><a href="#PostMapping" class="headerlink" title="PostMapping"></a>PostMapping</h3><h4 id="表单Bean提交"><a href="#表单Bean提交" class="headerlink" title="表单Bean提交"></a>表单Bean提交</h4><ul>
<li>方法参数为对象</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/save_user1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> User <span class="title function_">saveUser1</span><span class="params">(User user)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> user;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="JSON提交和-RequestBody接收"><a href="#JSON提交和-RequestBody接收" class="headerlink" title="JSON提交和@RequestBody接收"></a>JSON提交和@RequestBody接收</h4><ul>
<li>方法参数Bean添加 <strong>@RequestBody</strong></li>
<li>要通过application&#x2F;json提交</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/save_user2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map <span class="title function_">saveUser2</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">    <span class="keyword">return</span> map;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="PutMapping"><a href="#PutMapping" class="headerlink" title="PutMapping"></a>PutMapping</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PutMapping(&quot;/update/&#123;uid&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map <span class="title function_">updateUser</span><span class="params">(<span class="meta">@PathVariable(&quot;uid&quot;)</span>String uid)</span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;code&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;message&quot;</span>, uid + <span class="string">&quot;员工数据更新成功&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> map;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="DeleteMapping"><a href="#DeleteMapping" class="headerlink" title="DeleteMapping"></a>DeleteMapping</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping(&quot;/delete/&#123;uid&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map <span class="title function_">deleteUser</span><span class="params">(<span class="meta">@PathVariable(&quot;uid&quot;)</span>String uid)</span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;code&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;message&quot;</span>, uid + <span class="string">&quot;员工数据删除成功&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> map;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="XXXMapping的妙用"><a href="#XXXMapping的妙用" class="headerlink" title="XXXMapping的妙用"></a>XXXMapping的妙用</h3><h5 id="注解中的参数"><a href="#注解中的参数" class="headerlink" title="注解中的参数"></a>注解中的参数</h5><ul>
<li><strong>path</strong>：请求路径</li>
<li><strong>consumes</strong>：指定请求<strong>输入</strong>类型</li>
<li><strong>produces</strong>：指定请求<strong>返回</strong>类型</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(path = &quot;/box&quot;,produces = &#123;&quot;application/json&quot;,&quot;text/xml&quot;&#125;)</span></span><br><span class="line"><span class="comment">//这个控制类基础请求时/box  并且这个类下面全部方法的指定返回类型是JSON或者XML</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BoxController</span> &#123;</span><br><span class="line">   ...</span><br><span class="line">    <span class="meta">@PostMapping(consumes = &quot;application/json&quot;)</span></span><br><span class="line">       <span class="comment">//这个方法的请求类型是JSON</span></span><br><span class="line">    <span class="keyword">public</span> Box <span class="title function_">saveBox</span><span class="params">(<span class="meta">@RequestBody</span> Box box)</span>&#123;</span><br><span class="line">       ...</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h5 id="请求成功后返回Stats-状态码"><a href="#请求成功后返回Stats-状态码" class="headerlink" title="请求成功后返回Stats(状态码)"></a>请求成功后返回Stats(状态码)</h5><ul>
<li><p>方法级别 <strong>@ResponseStatus(HTTPStatus.状态码类型)</strong></p>
</li>
<li><p><strong>返回ResponseEntity对象</strong></p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>&lt;&gt;(返回对象/NUll,HTTPStatus.状态码类型);</span><br></pre></td></tr></table></figure>





<p>例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(path = &quot;/box&quot;,produces = &quot;application/json&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BoxController</span> &#123;</span><br><span class="line">   ...</span><br><span class="line">     <span class="meta">@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseStatus(code=HttpStatus.NO_CONTENT)</span></span><br><span class="line">       <span class="comment">//当请求到/box/&#123;id&#125; 服务器就会返回状态码NO_CONTENT(204)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity <span class="title function_">deleteBox</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            boxRepository.deleteById(id);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>(HttpStatus.OK);</span><br><span class="line">            <span class="comment">// 当删除数据成功 就返回ResponseEntity对象，并指定状态码OK(200)</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (EmptyResultDataAccessException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>&lt;&gt;(<span class="literal">null</span>,HttpStatus.NOT_FOUND);</span><br><span class="line">            <span class="comment">// 当抛出没有找到的异常时 就返回ResponseEntity对象，并指定响应体=null，返回状态码404</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="测试脚本"><a href="#测试脚本" class="headerlink" title="测试脚本"></a>测试脚本</h2><p>我们一般使用浏览器验证请求是否符合，过于麻烦，我们可以通过IDEA自带的测试脚本来验证.</p>
<h4 id="自动添加测试"><a href="#自动添加测试" class="headerlink" title="自动添加测试"></a>自动添加测试</h4><ul>
<li>点击连接的球<img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-19_192533.png" alt="屏幕截图 2022-01-19 192533"></li>
<li>测试文件(位于Scratches and Consoles-&gt;Scratches-&gt;generated-request.http)</li>
</ul>
<h4 id="各种请求测试"><a href="#各种请求测试" class="headerlink" title="各种请求测试"></a>各种请求测试</h4><h5 id="普通请求"><a href="#普通请求" class="headerlink" title="普通请求"></a>普通请求</h5><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">###测试使用</span><br><span class="line">GET http://localhost:8080/v1/hello</span><br></pre></td></tr></table></figure>

<h5 id="表单参数"><a href="#表单参数" class="headerlink" title="表单参数"></a>表单参数</h5><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">###</span><br><span class="line">GET http://localhost:8080/v1/page1?page=1&amp;rows=5</span><br></pre></td></tr></table></figure>

<h5 id="Header参数"><a href="#Header参数" class="headerlink" title="Header参数"></a>Header参数</h5><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">###</span><br><span class="line">GET http://localhost:8080/v1/get_header?id=456</span><br><span class="line">token:123</span><br></pre></td></tr></table></figure>

<h5 id="Bean对象参数"><a href="#Bean对象参数" class="headerlink" title="Bean对象参数"></a>Bean对象参数</h5><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">###</span><br><span class="line">POST http://localhost:8080/v1/save_user1</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">uid=123&amp;username=456&amp;pwd=789</span><br></pre></td></tr></table></figure>

<h5 id="JSON请求"><a href="#JSON请求" class="headerlink" title="JSON请求"></a>JSON请求</h5><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">###</span><br><span class="line">POST http://localhost:8080/v1/save_user2</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;uid&quot;: &quot;123&quot;,</span><br><span class="line">  &quot;username&quot;: &quot;456&quot;,</span><br><span class="line">  &quot;pwd&quot;: &quot;789&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="不重启服务器来更新内容"><a href="#不重启服务器来更新内容" class="headerlink" title="不重启服务器来更新内容"></a>不重启服务器来更新内容</h2><h4 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h4><p>在使用<strong>debug运行</strong>的时候，我们可以使用Reload Changed Classas来重载我们修改过的内容，这样我们不用完全重启整个服务器来更新内容.</p>
<h4 id="快捷键设置"><a href="#快捷键设置" class="headerlink" title="快捷键设置"></a>快捷键设置</h4><ul>
<li>ctrl+alt+s：打开设置</li>
<li>搜索reload，在Keymap中知道对应按键<img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-19_200726.png" alt="屏幕截图 2022-01-19 200726"></li>
</ul>
<h1 id="控制JSON输出"><a href="#控制JSON输出" class="headerlink" title="控制JSON输出"></a>控制JSON输出</h1><p>在SpringBoot中默认使用Jackson对javaBean进行序列化输出,我们可以通过给POJO类添加相关注解来控制JSON序列化的输出方式:</p>
<h4 id="JsonIgnore"><a href="#JsonIgnore" class="headerlink" title="@JsonIgnore"></a>@JsonIgnore</h4><p>忽略该属性，不对该属性进行序列化</p>
<h4 id="JsonFormat"><a href="#JsonFormat" class="headerlink" title="@JsonFormat"></a>@JsonFormat</h4><p>对该属性进行格式化操作，一般用在格式化日期</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;, locale = &quot;zh&quot;, timezone = &quot;GMT+8&quot;)</span></span><br></pre></td></tr></table></figure>

<ul>
<li>pattern：格式化形式</li>
<li>locale：本地语言</li>
<li>timezone：时区</li>
</ul>
<h4 id="JsonInclude"><a href="#JsonInclude" class="headerlink" title="@JsonInclude"></a>@JsonInclude</h4><p>给该属性添加条件，例如：</p>
<ul>
<li>当该属性为空的时候，进行序列化</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonInclude(JsonInclude.Include.NON_NULL)</span></span><br></pre></td></tr></table></figure>



<h4 id="JsonProperty"><a href="#JsonProperty" class="headerlink" title="@JsonProperty"></a>@JsonProperty</h4><p>给该属性添加别名</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonProperty(&quot;别名&quot;)</span></span><br></pre></td></tr></table></figure>



<h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><p>Pojo类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String uid;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="meta">@JsonIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String pwd;</span><br><span class="line">    <span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;, locale = &quot;zh&quot;, timezone = &quot;GMT+8&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date data;</span><br><span class="line">    <span class="meta">@JsonInclude(JsonInclude.Include.NON_NULL)</span></span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line">    <span class="meta">@JsonProperty(&quot;myun&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String un;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Controller层</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@GetMapping(&quot;/getUser&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getUser</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setData(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line"><span class="comment">//        user.setPhone(&quot;114514&quot;);</span></span><br><span class="line">        user.setUid(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">        user.setUn(<span class="string">&quot;456&quot;</span>);</span><br><span class="line">        user.setUsername(<span class="string">&quot;那是真的牛皮&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;uid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;123&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;那是真的牛皮&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2022-01-20&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;myun&quot;</span><span class="punctuation">:</span> <span class="string">&quot;456&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h1 id="SpringBoot的配置文件"><a href="#SpringBoot的配置文件" class="headerlink" title="SpringBoot的配置文件"></a>SpringBoot的配置文件</h1><h3 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h3><ul>
<li>.properties文件</li>
<li>.yaml文件</li>
</ul>
<p>两种文件作用都一样，但是书写不一样.</p>
<h3 id="书写格式-以yaml为例"><a href="#书写格式-以yaml为例" class="headerlink" title="书写格式(以yaml为例)"></a>书写格式(以yaml为例)</h3><ul>
<li>key： (<strong>这里双引号后面必须有个空格</strong>)value</li>
<li>用空格来层级递进</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/api</span></span><br><span class="line"><span class="attr">Jackson:</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">jackson:</span></span><br><span class="line">    <span class="attr">date-format:</span> <span class="string">yyyy-MM-dd</span> <span class="string">HH:mm:ss</span></span><br><span class="line">    <span class="attr">time-zone:</span> <span class="string">GMT+8</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">&quot;测试&quot;</span></span><br></pre></td></tr></table></figure>



<h3 id="常用配置"><a href="#常用配置" class="headerlink" title="常用配置"></a>常用配置</h3><ul>
<li><p>tomcat端口设置</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>tomcat上下文路径(在路径前面添加一个总路径)：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/api</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>应用名设置</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">&quot;测试&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Jackson的序列化输出的格式化日期</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">jackson:</span></span><br><span class="line">    <span class="attr">date-format:</span> <span class="string">yyyy-MM-dd</span> <span class="string">HH:mm:ss</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>jackson的时区设置</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">jackson:</span></span><br><span class="line">    <span class="attr">time-zone:</span> <span class="string">GMT+8</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="SpringBoot日志配置"><a href="#SpringBoot日志配置" class="headerlink" title="SpringBoot日志配置"></a>SpringBoot日志配置</h1><h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><h4 id="什么是日志"><a href="#什么是日志" class="headerlink" title="什么是日志"></a>什么是日志</h4><p>日志文件：记录系统操作事件的记录文件或文件集合</p>
<ul>
<li>事件日志</li>
<li>消息日志</li>
</ul>
<h4 id="Spring’Boot的日志设计"><a href="#Spring’Boot的日志设计" class="headerlink" title="Spring’Boot的日志设计"></a>Spring’Boot的日志设计</h4><p>Spring Boot提供<strong>slf4j</strong>这个接口来实现日志功能，一般使用log4j，logback等框架实现.</p>
<h5 id="slf4j"><a href="#slf4j" class="headerlink" title="slf4j"></a>slf4j</h5><p>slf4j（simple logging facade for java）是是一种规范，标准，接口，不是具体实现.</p>
<h5 id="logback"><a href="#logback" class="headerlink" title="logback"></a>logback</h5><p>logback和log4j都是slf4j的实现框架，而logback是一个”可靠，通用，快速而又灵活的Java日志框架“.</p>
<h2 id="日志配置"><a href="#日志配置" class="headerlink" title="日志配置"></a>日志配置</h2><h3 id="Spirng-Boot配置文件配置"><a href="#Spirng-Boot配置文件配置" class="headerlink" title="Spirng Boot配置文件配置"></a>Spirng Boot配置文件配置</h3><h4 id="常用配置-1"><a href="#常用配置-1" class="headerlink" title="常用配置"></a>常用配置</h4><ul>
<li>pattern：日志格式化<ul>
<li>file：写入文件的日志格式</li>
<li>console：输出控制台的日志格式</li>
</ul>
</li>
<li>file：输出日志文件<ul>
<li>name：日志具体存放地址</li>
</ul>
</li>
<li>level：输出日志等级<ul>
<li>root：根节点等级</li>
<li>具体包名：日志等级</li>
</ul>
</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">pattern:</span></span><br><span class="line">    <span class="attr">file:</span> <span class="string">&quot;%d&#123;yyyy/MM/dd?HH:mm&#125; [%thread] %-5level %logger? %msg%n&quot;</span></span><br><span class="line">    <span class="attr">console:</span> <span class="string">&quot;%d&#123;yyyy/MM/dd?HH:mm:ss&#125; [%thread] %-5level %logger? %msg%n&quot;</span></span><br><span class="line">  <span class="attr">file:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">C:\Users\user\Desktop\spd.log</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">root:</span> <span class="string">info</span></span><br><span class="line">    <span class="attr">com.springboot.firstspringboot2:</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure>



<h4 id="自定义输出日志"><a href="#自定义输出日志" class="headerlink" title="自定义输出日志"></a>自定义输出日志</h4><ul>
<li><p>在类中方法通过Logger工厂获得Logger对象，并且调用对应对象的方法，来输出日志内容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(<span class="built_in">this</span>.getClass());</span><br><span class="line">        logger.debug(<span class="string">&quot;输出内容&quot;</span>);</span><br><span class="line"><span class="comment">//1.创建Logger对象</span></span><br><span class="line"><span class="comment">//2.调用对象中方法输出相关内容</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在配置文件中指定包以及对应的日志等级(类似上面)</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">com.springboot.firstspringboot2:</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="logback配置文件配置"><a href="#logback配置文件配置" class="headerlink" title="logback配置文件配置"></a>logback配置文件配置</h3><p>由于Spring Boot的约定大于配置的设计，可以直接重写logback的配置文件来配置日志，logback配置文件的固定为：<strong>logback-spring.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--定义日志保存的路径--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;LOG_HOME&quot;</span> <span class="attr">value</span>=<span class="string">&quot;C:/Users/刘裕龙/Desktop/临时文件/logs/&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--定义一个控制台输出器，名为console--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;console&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--按pattern指定的格式输出日志，编码为UTF-8--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss&#125; %-5level [%thread]  %logger&#123;30&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--定义一个日滚动（每天生成一份）的日志文件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--按pattern指定的格式输出日志，编码为UTF-8--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss&#125; %-5level [%thread]  %logger&#123;30&#125; - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 定义保存的文件名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--%d&#123;yyyy-MM-dd&#125;代表每天生成一个新的日志--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;LOG_HOME&#125;/sprintboot_%d&#123;yyyy-MM-dd&#125;.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志最多保存90天，也就是90份--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>90<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 在日滚动文件中，强制只保存错误级别以上信息 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>INFO<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 定义日志全局最低输出级别是INFO，同时向控制台和日滚动文件输出 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;console&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h1 id="Freemark模板引擎"><a href="#Freemark模板引擎" class="headerlink" title="Freemark模板引擎"></a>Freemark模板引擎</h1><h2 id="模板引擎"><a href="#模板引擎" class="headerlink" title="模板引擎"></a>模板引擎</h2><h3 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h3><p>数据+模板–&gt;通过模板引擎–&gt;生成HTML</p>
<p>目的是解耦</p>
<h3 id="类型-1"><a href="#类型-1" class="headerlink" title="类型"></a>类型</h3><h4 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h4><ul>
<li>J2EE标准</li>
<li>太老</li>
<li>强耦合</li>
</ul>
<h4 id="thymealeaf"><a href="#thymealeaf" class="headerlink" title="thymealeaf"></a>thymealeaf</h4><ul>
<li>速度慢</li>
<li>很难用</li>
<li>很少用</li>
</ul>
<h4 id="Freemark"><a href="#Freemark" class="headerlink" title="Freemark"></a>Freemark</h4><ul>
<li><strong>xxx.ftl</strong>  FreeMarker Template Language(FTL)</li>
<li>依赖MVC模式，不依赖Servlet容器</li>
<li>容易使用，快速</li>
</ul>
<h2 id="Freemarker"><a href="#Freemarker" class="headerlink" title="Freemarker"></a>Freemarker</h2><h3 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="配置application-yaml"><a href="#配置application-yaml" class="headerlink" title="配置application.yaml"></a>配置application.yaml</h3><ul>
<li><strong>cache缓存</strong>：关闭</li>
<li><strong>设置字符集</strong>：UTF-8</li>
<li><strong>修改模板文件后缀：.ftl</strong><ul>
<li>默认为 .ftlh</li>
</ul>
</li>
<li><strong>格式化数字显示：0.##</strong><ul>
<li>显示前面整数，后面两位小数</li>
<li>默认为3位为一个单位，各一个添加一个逗号</li>
</ul>
</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">freemarker:</span></span><br><span class="line">    <span class="attr">cache:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">charset:</span> <span class="string">UTF-8</span></span><br><span class="line"><span class="comment">#    默认为.ftlh</span></span><br><span class="line">    <span class="attr">suffix:</span> <span class="string">.ftl</span></span><br><span class="line"><span class="comment">#    设置freemarker的配置项</span></span><br><span class="line">    <span class="attr">settings:</span></span><br><span class="line"><span class="comment">#      前面整数，后面两位小数</span></span><br><span class="line">      <span class="attr">number_format:</span> <span class="number">0</span><span class="string">.##</span></span><br></pre></td></tr></table></figure>





<h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><h5 id="三个取值语法"><a href="#三个取值语法" class="headerlink" title="三个取值语法"></a>三个取值语法</h5><ul>
<li>${变量}</li>
<li>${变量!默认值}</li>
<li>${变量？强制转换类型&#x2F;函数}</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;user.password&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;user.price!&quot;(数据为空时)测试默认值&quot;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;user.date?string(&quot;yyyy年MM月dd日&quot;)&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h5 id="调剂判断"><a href="#调剂判断" class="headerlink" title="调剂判断"></a>调剂判断</h5><ul>
<li><strong>&lt;#if 条件判断 &gt;包围</strong><ul>
<li><strong>&lt;#elseif 条件判断&gt;</strong></li>
<li><strong>&lt;#else&gt;</strong></li>
</ul>
</li>
</ul>
<h6 id="调剂判断-1"><a href="#调剂判断-1" class="headerlink" title="调剂判断"></a>调剂判断</h6><ul>
<li>括号</li>
<li><strong>变量？？</strong>：判断对象为空的方式</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;#if ifuser.price?? &gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>用户余额等于1000<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    &lt;#elseif (ifuser.price&gt;1000)&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>用户余额:$&#123;ifuser.price&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    &lt;#else&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>用户余额不足1000<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">&lt;/#if&gt;</span><br></pre></td></tr></table></figure>



<h5 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h5><ul>
<li><p>&lt;ul&gt;或者&lt;ol&gt;</p>
</li>
<li><p><strong>&lt;#list 集合变量 as 单个变量&gt;包围</strong></p>
<ul>
<li>&lt;li&gt;</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    &lt;#list users as u&gt;</span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span>&gt;</span>$&#123;u_index + 1&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>$&#123;u.username&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>$&#123;u.password&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>$&#123;u.date?string(&quot;yyyy年MM月dd日&quot;)&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>$&#123;u.price&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    &lt;/#list&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h5 id="include子页面"><a href="#include子页面" class="headerlink" title="include子页面"></a>include子页面</h5><p>实现页首和页尾</p>
<ul>
<li><strong>&lt;#include “其他ftl页面”&gt;</strong></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;#include &quot;OtherPage/header.ftl&quot;&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;user.username&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;user.password&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;user.date?string(&quot;yyyy年MM月dd日&quot;)&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>$&#123;user.price&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">&lt;#include &quot;OtherPage/floot.ftl&quot;&gt;</span><br></pre></td></tr></table></figure>



<h5 id="内置函数-了解即可"><a href="#内置函数-了解即可" class="headerlink" title="内置函数(了解即可)"></a>内置函数(了解即可)</h5><table>
<thead>
<tr>
<th>作用</th>
<th>函数名</th>
</tr>
</thead>
<tbody><tr>
<td>大小写转换</td>
<td>lower_case&#x2F;upper_case</td>
</tr>
<tr>
<td>首字母大写</td>
<td>cap_first</td>
</tr>
<tr>
<td>查找字符串索引</td>
<td>index_of</td>
</tr>
<tr>
<td>返回字符串长度</td>
<td>length</td>
</tr>
<tr>
<td>四舍五入&#x2F;下取整&#x2F;上取整</td>
<td>round&#x2F;floor&#x2F;ceiling</td>
</tr>
<tr>
<td>得到集合元素总数</td>
<td>size</td>
</tr>
<tr>
<td>获取第一个&#x2F;最后一个元素</td>
<td>first&#x2F;last</td>
</tr>
<tr>
<td>按某个属性对集合排序</td>
<td>sort_by</td>
</tr>
</tbody></table>
<h1 id="JUnit5单元测试"><a href="#JUnit5单元测试" class="headerlink" title="JUnit5单元测试"></a>JUnit5单元测试</h1><h4 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h4><p>对软件中最小部分进行检查和验证.</p>
<h2 id="JUnit5常用注解"><a href="#JUnit5常用注解" class="headerlink" title="JUnit5常用注解"></a>JUnit5常用注解</h2><h3 id="测试方法"><a href="#测试方法" class="headerlink" title="测试方法"></a>测试方法</h3><h4 id="类级别测试"><a href="#类级别测试" class="headerlink" title="类级别测试"></a>类级别测试</h4><ul>
<li><strong>@SpringBootTest(classes&#x3D;本类.class)</strong></li>
<li><strong>@TestInstance</strong><ul>
<li>Lifecycle.PER_METHOD<ul>
<li>本类的方法必须要静态</li>
<li>要关注实例常量的状态</li>
</ul>
</li>
<li>Lifecycle.PER_CLASS<ul>
<li>本类的方法不用静态</li>
<li>每次测试都是新的实例</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest(classes = TestAll.class)</span></span><br><span class="line"><span class="meta">@TestInstance(TestInstance.Lifecycle.PER_CLASS)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestAll</span> &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="普通测试"><a href="#普通测试" class="headerlink" title="普通测试"></a>普通测试</h4><p>进行一次简单的测试</p>
<ul>
<li><strong>@Test</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">oneTest</span><span class="params">()</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;测试一&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="参数化测试"><a href="#参数化测试" class="headerlink" title="参数化测试"></a>参数化测试</h4><p>可以一次性多个参数参数测试</p>
<h5 id="固定返回参数"><a href="#固定返回参数" class="headerlink" title="固定返回参数"></a>固定返回参数</h5><ul>
<li><strong>@ParameterizedTest</strong></li>
<li><strong>@ValueSource</strong>(类型&#x3D;{内容})</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ParameterizedTest</span></span><br><span class="line"><span class="meta">@ValueSource(strings = &#123;&quot;a&quot;,&quot;b&quot;,&quot;c&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testParamForMethodValue</span><span class="params">(String param)</span>&#123;</span><br><span class="line">    System.out.println(param);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="方法返回参数"><a href="#方法返回参数" class="headerlink" title="方法返回参数"></a>方法返回参数</h5><ul>
<li><strong>@ParameterizetedTest</strong></li>
<li><strong>@MethodSource</strong>(“方法民”)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ParameterizedTest</span></span><br><span class="line"><span class="meta">@MethodSource(&quot;getSource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testParamForMethodValue</span><span class="params">(String param)</span>&#123;</span><br><span class="line">    System.out.println(param);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> Stream&lt;String&gt; <span class="title function_">getSource</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Stream.of(<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;def&quot;</span>,<span class="string">&quot;ghi&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="重复测试"><a href="#重复测试" class="headerlink" title="重复测试"></a>重复测试</h4><ul>
<li><strong>RepeatedTest</strong>(重复次数)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RepeatedTest(10)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">repeatTest</span><span class="params">(TestInfo testInfo)</span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;测试&quot;</span>+testInfo.getDisplayName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="其他测试"><a href="#其他测试" class="headerlink" title="其他测试"></a>其他测试</h4><ul>
<li><p><strong>@BeforeAll</strong>：在所有单元测试之前执行</p>
</li>
<li><p><strong>@AfterAll</strong>：在所有单元测试之后执行</p>
</li>
<li><p>@<strong>BefroeEach</strong>：在每个单元测试之前执行</p>
</li>
<li><p>@<strong>AfterEach</strong>：在每个单元测试之后执行</p>
</li>
<li><p>@<strong>DisplayName</strong>(“描述”)：给每个测试单元添加描述</p>
</li>
<li><p>@<strong>Timeout</strong>：当测试方法运行超过某个时间就报错</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@Timeout(value = 190, unit = TimeUnit.MILLISECONDS)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">twoTest</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    Thread.sleep(<span class="number">200</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;测试二&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>@Tag</strong>:标签</p>
</li>
</ul>
<h3 id="断言"><a href="#断言" class="headerlink" title="断言"></a>断言</h3><p>上面的普通测试，只能保证程序是正确运行，不能保证结果参数是正确的.</p>
<p>当我们想要验证结果是否符合预期的时候，我就可以使用断言.</p>
<h4 id="一般断言使用"><a href="#一般断言使用" class="headerlink" title="一般断言使用"></a>一般断言使用</h4><p>在测试类中的测试方法添加断言，一般为Assertions.XXXX</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">  <span class="meta">@DisplayName(&quot;断言:值等于&quot;)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">assertEqualsTest</span><span class="params">()</span>&#123;</span><br><span class="line">      String a=<span class="string">&quot;abc&quot;</span>;</span><br><span class="line">      <span class="type">String</span> <span class="variable">b</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;abcd&quot;</span>);</span><br><span class="line">      Assertions.assertEquals(a,b,<span class="string">&quot;a和b值不相等&quot;</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>当a和b相同的时候，不输出后面的”a和b值不相等”</p>
</li>
<li><p>当a和b不相同(条件不符合)的时候，输出后面的”a和b值不相等”</p>
</li>
<li><p><strong>下面常见的断言也一样，当条件不符合（a为不符合的值，b为实际值）的时候，会输出后面的message</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Assertions.XXXX(不符合的值,实际的值,message);</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="常见断言"><a href="#常见断言" class="headerlink" title="常见断言"></a>常见断言</h4><table>
<thead>
<tr>
<th>断言</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>assertEquals</td>
<td>两个对象或原始类型是否相等</td>
</tr>
<tr>
<td>assertNotEquals</td>
<td>两个对象或原始类型是否不相等</td>
</tr>
<tr>
<td>assertSame</td>
<td>两个对象引用是否指向同一个对象</td>
</tr>
<tr>
<td>assertNotSame</td>
<td>两个对象应用是否指向不同的对象</td>
</tr>
<tr>
<td>assertTrue</td>
<td>给定的值是否为true</td>
</tr>
<tr>
<td>assertFalse</td>
<td>给的值是否为false</td>
</tr>
<tr>
<td>assertNull</td>
<td>给的值是否为空</td>
</tr>
<tr>
<td>assertNotNull</td>
<td>给的值是否不为空</td>
</tr>
</tbody></table>
<h1 id="MockMVC构建Web测试"><a href="#MockMVC构建Web测试" class="headerlink" title="MockMVC构建Web测试"></a>MockMVC构建Web测试</h1><h2 id="什么是Mock"><a href="#什么是Mock" class="headerlink" title="什么是Mock"></a>什么是Mock</h2><p>在面向对象的程序设计中，模拟对象（英语：mock object）是以可控的方式模拟真实对象行为的假对象。在编程过程中，通常通过模拟一些输入数据，来验证程序是否达到预期结果。</p>
<h2 id="为什么使用MockMVC"><a href="#为什么使用MockMVC" class="headerlink" title="为什么使用MockMVC"></a>为什么使用MockMVC</h2><ul>
<li>MockMvc是由spring-test包提供</li>
<li>实现了对Http请求的模拟，能够直接使用网络的形式转换到Controller的调用，使得测试速度快、不依赖网络环境。</li>
<li>同时提供了一套验证的工具，结果的验证十分方便</li>
</ul>
<h2 id="操作MockMVC"><a href="#操作MockMVC" class="headerlink" title="操作MockMVC"></a>操作MockMVC</h2><p>创建MockMVC测试类</p>
<h3 id="添加注解"><a href="#添加注解" class="headerlink" title="添加注解"></a>添加注解</h3><h4 id="类级别"><a href="#类级别" class="headerlink" title="类级别"></a>类级别</h4><ul>
<li><strong>SpringBootTest</strong><ul>
<li>classes：主方法类</li>
<li>webEnvironment：<ul>
<li>SpringBootTest.WebEnvironment.RANDOM_PORT：设置每次测试随机端口</li>
</ul>
</li>
</ul>
</li>
<li><strong>AutoConfigureMockMVC</strong></li>
</ul>
<h4 id="方法级别"><a href="#方法级别" class="headerlink" title="方法级别"></a>方法级别</h4><ul>
<li>方法添加@Test</li>
</ul>
<h4 id="注入MockMVC属性"><a href="#注入MockMVC属性" class="headerlink" title="注入MockMVC属性"></a>注入MockMVC属性</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest(classes = &#123;LaoQiSpringBoot2Application.class&#125;,webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)</span></span><br><span class="line"><span class="meta">@AutoConfigureMockMvc</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MockMvcTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> MockMvc mockMvc;</span><br><span class="line"></span><br><span class="line">    ....</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="MockMVC测试"><a href="#MockMVC测试" class="headerlink" title="MockMVC测试"></a>MockMVC测试</h3><ul>
<li>设置请求和参数<ul>
<li><strong>perform</strong></li>
</ul>
</li>
<li>期望条件和todo组合<ul>
<li><strong>andExpect</strong></li>
<li><strong>andDo</strong></li>
</ul>
</li>
<li>提交请求<ul>
<li><strong>andReturn</strong></li>
</ul>
</li>
</ul>
<h4 id="设置请求和参数perform"><a href="#设置请求和参数perform" class="headerlink" title="设置请求和参数perform"></a>设置请求和参数perform</h4><ul>
<li>模拟访问url，可以选择get或者post方法</li>
<li>添加各种参数</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mockMvc.perform(</span><br><span class="line">    MockMvcRequestBuilders.get(<span class="string">&quot;要访问的URL&quot;</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>



<h5 id="不添加参数"><a href="#不添加参数" class="headerlink" title="不添加参数"></a>不添加参数</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MockMvcRequestBuilders.get(<span class="string">&quot;要访问的地址&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMock1</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">   mockMvc.perform(MockMvcRequestBuilders.get(<span class="string">&quot;/v1/getLog&quot;</span>))</span><br><span class="line">          .andReturn();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="表单参数-1"><a href="#表单参数-1" class="headerlink" title="表单参数"></a>表单参数</h5><ul>
<li>param(“key”，value)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MockMvcRequestBuilders.get(<span class="string">&quot;要访问的地址&quot;</span>)</span><br><span class="line">        .param(<span class="string">&quot;key&quot;</span>, value)</span><br></pre></td></tr></table></figure>

<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMock1</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">   mockMvc.perform(</span><br><span class="line">   MockMvcRequestBuilders.get(<span class="string">&quot;/v1/getLog&quot;</span>)</span><br><span class="line">   .param(<span class="string">&quot;id&quot;</span>,<span class="number">123</span>)</span><br><span class="line">   )</span><br><span class="line">          .andReturn();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="header参数"><a href="#header参数" class="headerlink" title="header参数"></a>header参数</h5><ul>
<li>header(“key”,value)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MockMvcRequestBuilders.get(<span class="string">&quot;要访问的地址&quot;</span>)</span><br><span class="line">        .header(<span class="string">&quot;key&quot;</span>, value)</span><br></pre></td></tr></table></figure>

<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@DisplayName(&quot;JSON响应测试应用&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMock2</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    mockMvc.perform(MockMvcRequestBuilders.get(<span class="string">&quot;/v1/get_header&quot;</span>)</span><br><span class="line">            .header(<span class="string">&quot;token&quot;</span>, <span class="string">&quot;abcd&quot;</span>)</span><br><span class="line">    )</span><br><span class="line">            .andReturn();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="json参数"><a href="#json参数" class="headerlink" title="json参数"></a>json参数</h5><ul>
<li><strong>content</strong>(json的字符串)</li>
<li><strong>contentType(MediaType.APPLICATION_JSON_VALUE)</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MockMvcRequestBuilders.post(<span class="string">&quot;/v1/save_user2&quot;</span>)</span><br><span class="line">                        .accept(MediaType.APPLICATION_JSON_UTF8_VALUE)</span><br><span class="line">                        .content(s1)</span><br><span class="line">                        .contentType(MediaType.APPLICATION_JSON_VALUE)</span><br></pre></td></tr></table></figure>



<h6 id="HashMap转json字符串"><a href="#HashMap转json字符串" class="headerlink" title="HashMap转json字符串"></a>HashMap转json字符串</h6><ul>
<li>HashMap对象</li>
<li>ObjectMapper对象</li>
<li><strong>writeValueAsString</strong>方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"><span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">map.put(<span class="string">&quot;myun&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">String  = mapper.writeValueAsString(map);</span><br></pre></td></tr></table></figure>



<h6 id="对象转json字符串-以jackson为例子"><a href="#对象转json字符串-以jackson为例子" class="headerlink" title="对象转json字符串(以jackson为例子)"></a>对象转json字符串(以jackson为例子)</h6><ul>
<li>ObjectMapper对象</li>
<li>writeValueAsString方法</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//object转json</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setId(<span class="number">5</span>);</span><br><span class="line">        user.setUser_age(<span class="number">14</span>);</span><br><span class="line">        user.setUser_name(<span class="string">&quot;测试用户&quot;</span>);</span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> objectMapper.writeValueAsString(user);</span><br></pre></td></tr></table></figure>





<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMock4</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line"></span><br><span class="line">    map.put(<span class="string">&quot;uid&quot;</span>, <span class="string">&quot;123&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;用户名字&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> mapper.writeValueAsString(map);</span><br><span class="line">    </span><br><span class="line">   mockMvc.perform(MockMvcRequestBuilders.post(<span class="string">&quot;/v1/save_user2&quot;</span>)</span><br><span class="line">                    .accept(MediaType.APPLICATION_JSON_UTF8_VALUE)</span><br><span class="line">                    .content(s1)</span><br><span class="line">                    .contentType(MediaType.APPLICATION_JSON_VALUE)</span><br><span class="line">            )</span><br><span class="line">                            .andReturn();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h5 id="解决响应的乱码"><a href="#解决响应的乱码" class="headerlink" title="解决响应的乱码"></a>解决响应的乱码</h5><ul>
<li>上面的各种参数上传时候，都会默认UTF-8编码</li>
<li>响应数据必须要使用accept来设置UTF-8编码</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.accept(MediaType.APPLICATION_JSON_UTF8_VALUE)</span><br><span class="line">    <span class="comment">//虽然APPLICATION_JSON_UTF8_VALUE弃用，但其实依然是会生效的</span></span><br></pre></td></tr></table></figure>



<h4 id="期望条件andExpect"><a href="#期望条件andExpect" class="headerlink" title="期望条件andExpect"></a>期望条件andExpect</h4><p>当我们设置请求后，我们希望响应满足我们一些条件，就可以用这个玩意.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.andExpect(MockMvcResultMatchers.XXXXX)</span><br></pre></td></tr></table></figure>



<h5 id="判断符合请求"><a href="#判断符合请求" class="headerlink" title="判断符合请求"></a>判断符合请求</h5><ul>
<li>判断请求成功，也就是状态码是不是200</li>
<li>当状态码不符合的时候，就会抛出测试错误</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.andExpect(MockMvcResultMatchers.status().isOk())</span><br></pre></td></tr></table></figure>

<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@DisplayName(&quot;JSON响应测试应用&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMock2</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    mockMvc.perform(MockMvcRequestBuilders.get(<span class="string">&quot;/v1/get_header&quot;</span>)</span><br><span class="line">            .header(<span class="string">&quot;token&quot;</span>, <span class="string">&quot;abcd&quot;</span>)</span><br><span class="line">            .param(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;123&quot;</span>)</span><br><span class="line">    ).andExpect(MockMvcResultMatchers.status().isOk())</span><br><span class="line">            .andReturn();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="判断json是否符合"><a href="#判断json是否符合" class="headerlink" title="判断json是否符合"></a>判断json是否符合</h5><ul>
<li>判断json的值是否符合</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.andExpect(MockMvcResultMatchers.jsonPath(<span class="string">&quot;key值&quot;</span>).value(<span class="string">&quot;value值&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="meta">@DisplayName(&quot;JSON响应测试应用&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMock2</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    mockMvc.perform(MockMvcRequestBuilders.get(<span class="string">&quot;/v1/get_header&quot;</span>)</span><br><span class="line">            .header(<span class="string">&quot;token&quot;</span>, <span class="string">&quot;abcd&quot;</span>)</span><br><span class="line">            .param(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;123&quot;</span>)</span><br><span class="line">    )</span><br><span class="line">            .andExpect(MockMvcResultMatchers.jsonPath(<span class="string">&quot;access_token&quot;</span>).value(<span class="string">&quot;abcd&quot;</span>))</span><br><span class="line">            .andReturn();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="匹配操作andDo"><a href="#匹配操作andDo" class="headerlink" title="匹配操作andDo"></a>匹配操作andDo</h4><p>一般来说，当我们符合期望条件后，可以再做下一步的测试，当然也可以单独使用..</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.andDo(MockMvcResultHandlers.XXXX)</span><br></pre></td></tr></table></figure>



<h5 id="输出内容"><a href="#输出内容" class="headerlink" title="输出内容"></a>输出内容</h5><ul>
<li>单纯输出各种内容</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.andDo(MockMvcResultHandlers.print())</span><br></pre></td></tr></table></figure>

<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="meta">@DisplayName(&quot;JSON响应测试应用&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMock2</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">       mockMvc.perform(MockMvcRequestBuilders.get(<span class="string">&quot;/v1/get_header&quot;</span>)</span><br><span class="line">               .header(<span class="string">&quot;token&quot;</span>, <span class="string">&quot;abcd&quot;</span>)</span><br><span class="line">               .param(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;123&quot;</span>)</span><br><span class="line">       ).andExpect(MockMvcResultMatchers.status().isOk())</span><br><span class="line">               .andDo(MockMvcResultHandlers.print())</span><br><span class="line">               .andExpect(MockMvcResultMatchers.jsonPath(<span class="string">&quot;access_token&quot;</span>).value(<span class="string">&quot;abcd&quot;</span>))</span><br><span class="line">               .andReturn();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h4 id="提交请求-必须-andReturn"><a href="#提交请求-必须-andReturn" class="headerlink" title="提交请求(必须)andReturn"></a>提交请求(必须)andReturn</h4><ul>
<li>在上面的流式编程完成后,最后必须以.andReturn作为结尾</li>
<li>.andReturn才是真正发出请求的时候</li>
</ul>
<h1 id="标准化404和500异常"><a href="#标准化404和500异常" class="headerlink" title="标准化404和500异常"></a>标准化404和500异常</h1><h2 id="为什么标准化404和500"><a href="#为什么标准化404和500" class="headerlink" title="为什么标准化404和500"></a>为什么标准化404和500</h2><p>在前后端分离应用的情况下，前端发送http请求个springboot里面的tomcat容器，tomcat容器再发送json数据给前端.</p>
<p>前端必须全部都接收json，但是404和500都会显示默认错误页面，而不是返回json.所以我们需要把404和500的异常都变成标准的json返回.</p>
<h2 id="布置全局异常拦截"><a href="#布置全局异常拦截" class="headerlink" title="布置全局异常拦截"></a>布置全局异常拦截</h2><h3 id="开发全局异常处理通知"><a href="#开发全局异常处理通知" class="headerlink" title="开发全局异常处理通知"></a>开发全局异常处理通知</h3><h4 id="对404异常进行配置"><a href="#对404异常进行配置" class="headerlink" title="对404异常进行配置"></a>对404异常进行配置</h4><p>在apllication.yaml中设置404抛出NoHandlerFoundException，并且关闭默认资源映射.这样当访问404时候，不再显示默认的404错误页面，而是返回json数据.</p>
<ul>
<li>spring.mvc.<strong>throw-exception-if-no-handler-found</strong>: true</li>
<li>spring.mvc.resources.add-mappings: false</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="comment">#      出现404错误 直接抛出NoHandlerFoundException</span></span><br><span class="line">  <span class="attr">mvc:</span></span><br><span class="line">    <span class="attr">throw-exception-if-no-handler-found:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment">#    关闭默认资源映射，会导致static静态资源无法映射</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">      <span class="attr">add-mappings:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>



<h4 id="创建异常处理类"><a href="#创建异常处理类" class="headerlink" title="创建异常处理类"></a>创建异常处理类</h4><p>Srping Boot提供内置的<strong>AOP通知</strong>实现404或者500异常的全局处理</p>
<ol>
<li>在类上添加 <strong>@RestControllerAdvice</strong>（环绕通知）</li>
<li>在方法中添加 <strong>@ExceptionHandler</strong>（要处理的异常类.class）<ul>
<li>一般返回<strong>Exception.class</strong>（也就是所有异常类的父类）</li>
</ul>
</li>
<li>使用Exception参数</li>
<li>返回Object（返回json）</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ControllerHandlerException</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(<span class="built_in">this</span>.getClass());</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">    Object <span class="title function_">handleException</span><span class="params">(Exception e, HttpServletRequest request)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (e <span class="keyword">instanceof</span> NoHandlerFoundException) &#123;</span><br><span class="line">            map.put(<span class="string">&quot;code&quot;</span>, <span class="number">404</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            map.put(<span class="string">&quot;code&quot;</span>, <span class="number">500</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        map.put(<span class="string">&quot;exception&quot;</span>, e.getClass().getSimpleName());</span><br><span class="line">        map.put(<span class="string">&quot;msg&quot;</span>, e.getMessage());</span><br><span class="line">        logger.error(<span class="string">&quot;捕捉Web应用抛出错误&quot;</span>, e);</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h1 id="拦截器Interceptor"><a href="#拦截器Interceptor" class="headerlink" title="拦截器Interceptor"></a>拦截器Interceptor</h1><p>在平时我们需要对用户的请求进行拦截并作出相应处理.</p>
<p>一般用来权限验证，记录请求信息，判断用户是否登录等</p>
<h2 id="创建拦截器类"><a href="#创建拦截器类" class="headerlink" title="创建拦截器类"></a>创建拦截器类</h2><ul>
<li>创建拦截器类</li>
<li>继承<strong>HandlerInterceptor</strong></li>
<li>重写<strong>preHandler</strong>和<strong>postHandler</strong>方法<ul>
<li>在用户请求之前或之后，进行拦截<ul>
<li>返回false，则拦截</li>
<li>返回ture，则放行</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="拦截方法"><a href="#拦截方法" class="headerlink" title="拦截方法"></a>拦截方法</h3><ul>
<li><strong>前置拦截</strong>preHandle<ul>
<li>验证token</li>
<li>权限验证</li>
</ul>
</li>
<li><strong>后置拦截</strong>postHandle</li>
</ul>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(token!=<span class="literal">null</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//       输出json</span></span><br><span class="line">        LinkedHashMap&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;code&quot;</span>, <span class="string">&quot;500&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;验证token失败&quot;</span>);</span><br><span class="line"><span class="comment">//      jackson序列化</span></span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> mapper.writeValueAsString(mapper);</span><br><span class="line"></span><br><span class="line">        response.setContentType(<span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">        response.getWriter().println(s);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        HandlerInterceptor.<span class="built_in">super</span>.postHandle(request, response, handler, modelAndView);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="拦截器类映射"><a href="#拦截器类映射" class="headerlink" title="拦截器类映射"></a>拦截器类映射</h2><ul>
<li>创建配置类，添加 <strong>@Configuration</strong></li>
<li>继承<strong>WebMvcConfigurer</strong></li>
<li>重写<strong>addInterceptors</strong>添加拦截器映射</li>
</ul>
<h3 id="addInterceptors方法"><a href="#addInterceptors方法" class="headerlink" title="addInterceptors方法"></a>addInterceptors方法</h3><ul>
<li><strong>addInterceptor</strong>（拦截器类对象）</li>
<li><strong>addPathPatterns</strong>（”拦截地址”）</li>
<li><strong>excludePathPatterns</strong>（”排除拦截地址”）</li>
</ul>
<h5 id="路径设置"><a href="#路径设置" class="headerlink" title="路径设置"></a>路径设置</h5><ul>
<li>拦截所有链接：&#x2F;**</li>
<li>拦截多个地址：String数组</li>
<li>拦截单个地址：String</li>
</ul>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptorConfigure</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">MyInterceptor</span>())</span><br><span class="line">                .addPathPatterns(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                .excludePathPatterns(<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/static/**&quot;</span>, <span class="string">&quot;/img/**&quot;</span>&#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="资源映射"><a href="#资源映射" class="headerlink" title="资源映射"></a>资源映射</h2><p>使用WebMvcConfiguration方法，对静态资源进行放行</p>
<ul>
<li>继承<strong>WebMvcConfigurer</strong>类</li>
<li>重写<strong>addResourceHandlers</strong>方法<ul>
<li><strong>addResourceHandler</strong>(“请求路径”)</li>
<li><strong>addResourceLocations</strong>(“映射路径”)</li>
</ul>
</li>
<li>设置映射</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptorConfigure</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/static/**&quot;</span>).addResourceLocations(<span class="string">&quot;classpath:/static/&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="Actuator和Endpoint"><a href="#Actuator和Endpoint" class="headerlink" title="Actuator和Endpoint"></a>Actuator和Endpoint</h1><h2 id="什么使用Actuator"><a href="#什么使用Actuator" class="headerlink" title="什么使用Actuator"></a>什么使用Actuator</h2><p>在一个微服务在云上部署之后，我们要对其进行监控，追踪，审计，控制等.</p>
<p>文档地址：</p>
<p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.4.6/reference/html/production-ready-features.html#production-ready">https://docs.spring.io/spring-boot/docs/2.4.6/reference/html/production-ready-features.html#production-ready</a></p>
<h2 id="如何使用Actuator"><a href="#如何使用Actuator" class="headerlink" title="如何使用Actuator"></a>如何使用Actuator</h2><h4 id="添加依赖"><a href="#添加依赖" class="headerlink" title="添加依赖"></a>添加依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="暴露接口"><a href="#暴露接口" class="headerlink" title="暴露接口"></a>暴露接口</h4><h5 id="开启所有监控管理"><a href="#开启所有监控管理" class="headerlink" title="开启所有监控管理"></a>开启所有监控管理</h5><p>actuator下面所有端点开启</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">enabled-by-default:</span> <span class="literal">true</span> <span class="comment">#开启所有监控</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">&#x27;*&#x27;</span></span><br></pre></td></tr></table></figure>

<h5 id="启用端点"><a href="#启用端点" class="headerlink" title="启用端点"></a>启用端点</h5><p>因为安全问题，所以不会开启所有端点.</p>
<p>会选择用一个功能开启一个端点，enabled：true</p>
<p><strong>注意查询文档，看该端点是WEB支持还是JMX支持</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">enabled-by-default:</span> <span class="literal">false</span> <span class="comment">#开启所有监控</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">&#x27;*&#x27;</span></span><br><span class="line">  <span class="attr">endpoint:</span>  <span class="comment">#对外暴露端点</span></span><br><span class="line">    <span class="attr">health:</span></span><br><span class="line">      <span class="attr">show-details:</span> <span class="string">always</span> <span class="comment">#显示健康状态的信息</span></span><br><span class="line">      <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">info:</span></span><br><span class="line">      <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">metrics:</span></span><br><span class="line">      <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h5 id="常用端点"><a href="#常用端点" class="headerlink" title="常用端点"></a>常用端点</h5><ul>
<li>health</li>
<li>info</li>
<li>metrics</li>
</ul>
<h4 id="访问路径"><a href="#访问路径" class="headerlink" title="访问路径"></a>访问路径</h4><ul>
<li>访问总路径：<a target="_blank" rel="noopener" href="http://localhost:8080/actuator">http://localhost:8080/actuator</a><ul>
<li>以超链接的方式返回下级可访问连接</li>
</ul>
</li>
<li>访问端点路径：<a target="_blank" rel="noopener" href="http://localhost:8080/actuator/XXXX">http://localhost:8080/actuator/XXXX</a><ul>
<li>例：访问health端点：<a target="_blank" rel="noopener" href="http://localhost:8080/actuator/health">http://localhost:8080/actuator/health</a></li>
</ul>
</li>
</ul>
<h2 id="常用端点列表"><a href="#常用端点列表" class="headerlink" title="常用端点列表"></a>常用端点列表</h2><table>
<thead>
<tr>
<th>端点</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>auditevents</td>
<td>暴露当前应用程序的审核信息.需要一个AuditEventRepository组件</td>
</tr>
<tr>
<td>beans</td>
<td>显示应用程序中所有Spring bean的完整列表。</td>
</tr>
<tr>
<td>conditions</td>
<td>显示自己配置的所以条件信息，包括匹配或者不匹配的原因</td>
</tr>
<tr>
<td>caches</td>
<td>暴露可用的缓存。</td>
</tr>
<tr>
<td>configprops</td>
<td>显示所有@ConfigurationProperties</td>
</tr>
<tr>
<td>env</td>
<td>露出Spring的属性ConfigurableEnvironment</td>
</tr>
<tr>
<td>flyway</td>
<td>显示已应用的所有Flyway数据库迁移，需要一个或对各Flyway组件</td>
</tr>
<tr>
<td>health</td>
<td>显示应用程序运行状态信息</td>
</tr>
<tr>
<td>httptrace</td>
<td>显示HTTP跟踪信息（默认情况下，最后100个HTTP请求 - 响应交换）.需要一个HttpTraceRepository组件</td>
</tr>
<tr>
<td>info</td>
<td>显示应用程序信息</td>
</tr>
<tr>
<td>integrationgraph</td>
<td>显示Spring intergrationraph，需要依赖spring-integration-core</td>
</tr>
<tr>
<td>loggers</td>
<td>显示和修改应用程序中日志的配置</td>
</tr>
<tr>
<td>liquibase</td>
<td>显示已应用的所有Liquibase数据库迁移.需要一个或多个Liquibase组件</td>
</tr>
<tr>
<td>metrics</td>
<td>显示当前应用程序的”指标“信息</td>
</tr>
<tr>
<td>mappings</td>
<td>显示所有@RequestMapping路径列表</td>
</tr>
<tr>
<td>scheduledtasks</td>
<td>显示应用程序中的计划任务</td>
</tr>
<tr>
<td>sessions</td>
<td>允许从Spring Session支持的会话存储中检索和删除用户会话，需要使用Spring Session的基于Servlet的Web应用程序</td>
</tr>
<tr>
<td>shutdown</td>
<td>显示由ApplicationStartup收集的启动步骤数据.需要使用SpringApplication进行配置BufferingApplicationStartup</td>
</tr>
<tr>
<td>threaddump</td>
<td>执行线程转储。</td>
</tr>
</tbody></table>
<h1 id="Spring-Boot-Admin"><a href="#Spring-Boot-Admin" class="headerlink" title="Spring-Boot-Admin"></a>Spring-Boot-Admin</h1><h2 id="Spring-Boot-Admin作用"><a href="#Spring-Boot-Admin作用" class="headerlink" title="Spring-Boot-Admin作用"></a>Spring-Boot-Admin作用</h2><p>管理和监视Spring Boot应用程序.提供：</p>
<ul>
<li>详细的健康(Health)信息</li>
<li>内存信息</li>
<li>JVM系统和环境属性</li>
<li>垃圾回收信息</li>
<li>日志设置和查看</li>
<li>定时任务查看</li>
<li>Spring Boot缓存查看和管理</li>
<li>等</li>
</ul>
<p>功能.</p>
<p>文档:<a target="_blank" rel="noopener" href="https://codecentric.github.io/spring-boot-admin/2.3.1/">https://codecentric.github.io/spring-boot-admin/2.3.1/</a></p>
<h2 id="Spring-Boot-Admin配置"><a href="#Spring-Boot-Admin配置" class="headerlink" title="Spring-Boot-Admin配置"></a>Spring-Boot-Admin配置</h2><p>Spring-Boot-Admin采用C&#x2F;S的模式，有一个Admin服务器用来监控一个或多个Admin client的Spring boot项目，且项目中添加了actuator框架.</p>
<h3 id="Admin服务器"><a href="#Admin服务器" class="headerlink" title="Admin服务器"></a>Admin服务器</h3><h4 id="添加依赖-1"><a href="#添加依赖-1" class="headerlink" title="添加依赖"></a>添加依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>de.codecentric<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-admin-starter-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="修改端口"><a href="#修改端口" class="headerlink" title="修改端口"></a>修改端口</h4><p>防止和客户端冲突</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server.port=9000</span><br></pre></td></tr></table></figure>



<h4 id="主启动类添加-EnableAdminServer"><a href="#主启动类添加-EnableAdminServer" class="headerlink" title="主启动类添加@EnableAdminServer"></a>主启动类添加@EnableAdminServer</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableAdminServer</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AdminServerApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(AdminServerApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="Admin客户端"><a href="#Admin客户端" class="headerlink" title="Admin客户端"></a>Admin客户端</h3><h4 id="添加依赖-2"><a href="#添加依赖-2" class="headerlink" title="添加依赖"></a>添加依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>de.codecentric<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-admin-starter-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="指向Admin服务器"><a href="#指向Admin服务器" class="headerlink" title="指向Admin服务器"></a>指向Admin服务器</h4><ul>
<li>spring.boot.admin.client.url：指向Admin服务器地址</li>
<li>spring.boot.admin.client.instance.prefer-ip：开启基于IP进行注册，默认为域名注册</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">boot:</span></span><br><span class="line">    <span class="attr">admin:</span></span><br><span class="line">      <span class="attr">client:</span></span><br><span class="line">        <span class="attr">url:</span> <span class="string">http://127.0.0.1:9000</span> <span class="comment">#服务器地址</span></span><br><span class="line">        <span class="attr">instance:</span></span><br><span class="line">          <span class="attr">prefer-ip:</span> <span class="literal">true</span> <span class="comment">#基于IP进行注册</span></span><br></pre></td></tr></table></figure>



<h3 id="操作SpringBootAdmin页面"><a href="#操作SpringBootAdmin页面" class="headerlink" title="操作SpringBootAdmin页面"></a>操作SpringBootAdmin页面</h3><ul>
<li>访问 <a target="_blank" rel="noopener" href="http://localhost:9000/">http://localhost:9000</a></li>
</ul>
<p><img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-27_092845.png" alt="屏幕截图 2022-01-27 092845"></p>
<p><img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-27_092926.png" alt="屏幕截图 2022-01-27 092926"></p>
<h4 id="异常监控"><a href="#异常监控" class="headerlink" title="异常监控"></a>异常监控</h4><ul>
<li>OFFLINE：服务挂掉</li>
<li>UP：正常运行</li>
</ul>
<p><img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-27_093118.png" alt="屏幕截图 2022-01-27 093118"></p>
<h2 id="配置查看更多监控项"><a href="#配置查看更多监控项" class="headerlink" title="配置查看更多监控项"></a>配置查看更多监控项</h2><h3 id="确保配置actuator"><a href="#确保配置actuator" class="headerlink" title="确保配置actuator"></a>确保配置actuator</h3><h4 id="添加依赖-3"><a href="#添加依赖-3" class="headerlink" title="添加依赖"></a>添加依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="开放所有端点"><a href="#开放所有端点" class="headerlink" title="开放所有端点"></a>开放所有端点</h4><p>在application.yaml里配置，</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">enabled-by-default:</span> <span class="literal">true</span> <span class="comment">#开启所有监控</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">&#x27;*&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="更多监控项"><a href="#更多监控项" class="headerlink" title="更多监控项"></a>更多监控项</h3><p>在actuator开启全部端点后，可以看到以下内容：</p>
<ul>
<li>启动时间、累计运行时间；</li>
<li>进程和线程数量和占用的 CPU 资源；</li>
<li>垃圾回收详情信息，回收次数和花费时间；</li>
<li>JVM 线程转储、内存转储详情和对应的文件下载；</li>
<li>可以查看和配置 Spring Boot 项目中的日志级别；</li>
<li>查看 Spring Boot 项目性能监控；</li>
<li>查看 Spring Boot 运行环境信息；</li>
<li>查看 Spring Boot 所有类信息；</li>
<li>查看 Spring Boot 中的定时任务；</li>
<li>查看和管理 Spring Boot 项目中的所有缓存。</li>
</ul>
<h4 id="查看运行环境"><a href="#查看运行环境" class="headerlink" title="查看运行环境"></a>查看运行环境</h4><p><img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-27_094448.png" alt="屏幕截图 2022-01-27 094448"></p>
<h4 id="查看定时任务"><a href="#查看定时任务" class="headerlink" title="查看定时任务"></a>查看定时任务</h4><p><img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-27_094506.png" alt="屏幕截图 2022-01-27 094506"></p>
<h4 id="项目日志级别配置"><a href="#项目日志级别配置" class="headerlink" title="项目日志级别配置"></a>项目日志级别配置</h4><p>可以很可观的看到日志级别，并且很容易设置</p>
<p><img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-27_094559.png" alt="屏幕截图 2022-01-27 094559"></p>
<h4 id="JVM线程和内存查看"><a href="#JVM线程和内存查看" class="headerlink" title="JVM线程和内存查看"></a>JVM线程和内存查看</h4><p><img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-27_094702.png" alt="屏幕截图 2022-01-27 094702"></p>
<h4 id="查看缓存"><a href="#查看缓存" class="headerlink" title="查看缓存"></a>查看缓存</h4><p><img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-27_094726.png" alt="屏幕截图 2022-01-27 094726"></p>
<h4 id="配置项目实时日志"><a href="#配置项目实时日志" class="headerlink" title="配置项目实时日志"></a>配置项目实时日志</h4><ul>
<li><p>在客户端设置logback日志地址</p>
  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">file:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">日志地址</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查看Admin日志</p>
</li>
</ul>
<p><img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-27_094411.png" alt="屏幕截图 2022-01-27 094411"></p>
<h1 id="Spring-Boot-Profile"><a href="#Spring-Boot-Profile" class="headerlink" title="Spring-Boot-Profile"></a>Spring-Boot-Profile</h1><h2 id="为什么使用Profile"><a href="#为什么使用Profile" class="headerlink" title="为什么使用Profile"></a>为什么使用Profile</h2><ul>
<li>Profile是Spring对<strong>不同环境提供不同配置</strong>功能的支持(方便多环境适配)</li>
<li>可以通过多种方式激活<ul>
<li>默认application.yml激活</li>
<li>生产环境激活</li>
<li>命令行参数激活</li>
</ul>
</li>
<li>通过Profile，<strong>在不同环境创建不同的bean</strong></li>
</ul>
<h2 id="配置属性"><a href="#配置属性" class="headerlink" title="配置属性"></a>配置属性</h2><p>我们不希望把对象中参数直接写死在程序中，我们希望可以通过配置application.yml中的属性来控制对象的参数.所以有了配置属性.</p>
<h3 id="引入其他配置属性"><a href="#引入其他配置属性" class="headerlink" title="引入其他配置属性"></a>引入其他配置属性</h3><p>从其他的配置属性注入到其他配置</p>
<h5 id="占位符"><a href="#占位符" class="headerlink" title="${}占位符"></a>${}占位符</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">a:</span></span><br><span class="line"> <span class="attr">b:</span> <span class="string">you</span> <span class="string">$&#123;b.c&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="创建自己的配置属性"><a href="#创建自己的配置属性" class="headerlink" title="创建自己的配置属性"></a>创建自己的配置属性</h3><h4 id="创建配置属性-ConfigurationProperties"><a href="#创建配置属性-ConfigurationProperties" class="headerlink" title="创建配置属性@ConfigurationProperties"></a>创建配置属性@ConfigurationProperties</h4><ol>
<li><p>首先在需要配置属性的类中添加</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;mybean&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InsertBean</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String a;</span><br><span class="line">    <span class="keyword">private</span> String b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>在<strong>application.yml</strong>配置属性</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybean:</span></span><br><span class="line">  <span class="attr">a:</span> <span class="string">&quot;测试&quot;</span></span><br><span class="line">  <span class="attr">b:</span> <span class="string">&quot;测试&quot;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="给配置属性添加文档"><a href="#给配置属性添加文档" class="headerlink" title="给配置属性添加文档"></a>给配置属性添加文档</h4><ul>
<li><p>将光标放到.yaml文件中的配置属性<img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-27_164350.png" alt="屏幕截图 2022-01-27 164350"></p>
</li>
<li><p>新生成文件<img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-27_164425.png" alt="屏幕截图 2022-01-27 164425"></p>
</li>
<li><p>新生成json，修改注释</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="comment">//配置属性的全名</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mybean.b&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="comment">//配置属性的参数类全名</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;java.lang.String&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="comment">//这个配置属性的简短描述</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;我是b.&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>显示效果<img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-27_173224.png" alt="屏幕截图 2022-01-27 173224"></p>
</li>
</ul>
<h2 id="用Profile进行配置"><a href="#用Profile进行配置" class="headerlink" title="用Profile进行配置"></a>用Profile进行配置</h2><h4 id="不同的配置profile配置文件"><a href="#不同的配置profile配置文件" class="headerlink" title="不同的配置profile配置文件"></a>不同的配置profile配置文件</h4><ul>
<li>默认配置文件application.yml任何时候都会加载</li>
<li>不同开发环境配置<ul>
<li>命名规则：<strong>application-{profile名}.yml</strong></li>
</ul>
</li>
</ul>
<p>例子</p>
<ul>
<li>application-dev.yml  代表dev环境</li>
<li>application-prod.yml  代表prod环境</li>
<li>application-test.yml   代表test环境</li>
</ul>
<h4 id="激活优先级别"><a href="#激活优先级别" class="headerlink" title="激活优先级别"></a>激活优先级别</h4><p>环境配置文件&gt;默认配置文件</p>
<h4 id="激活profile"><a href="#激活profile" class="headerlink" title="激活profile"></a>激活profile</h4><h5 id="默认激活"><a href="#默认激活" class="headerlink" title="默认激活"></a>默认激活</h5><ul>
<li>在<strong>application.yml</strong></li>
</ul>
 <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">   <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">环境名(例如&quot;dev&quot;)</span></span><br><span class="line">    <span class="comment">#代表默认激活dev这个环境的配置属性</span></span><br></pre></td></tr></table></figure>


<h5 id="激活"><a href="#激活" class="headerlink" title="激活"></a>激活</h5><ul>
<li><p><strong>命令行参数启动</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">% java -jar 包名.jar --spring.profiles.active=dev</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="使用profile条件化创建bean"><a href="#使用profile条件化创建bean" class="headerlink" title="使用profile条件化创建bean"></a>使用profile条件化创建bean</h2><p>不同环境不用配置参数，同时我们希望IOC容器中加载不同的bean，</p>
<p>我们在以java方式配置类添加@Profile注解，来控制加载.</p>
<h5 id="Profile注解使用"><a href="#Profile注解使用" class="headerlink" title="@Profile注解使用"></a>@Profile注解使用</h5><ul>
<li>@Profile(“环境名”)</li>
<li>@Profile({“环境名1”,”环境名2,”…..})</li>
<li><strong>!符号代表不激活</strong><ul>
<li>@Profile({“！环境名1”,”！环境名2,”…..})</li>
<li><strong>当环境1和环境2不激活的时候，这个bean才被创建</strong></li>
</ul>
</li>
</ul>
<h5 id="在java方式配置类的"><a href="#在java方式配置类的" class="headerlink" title="在java方式配置类的"></a>在java方式配置类的</h5><ul>
<li><p>@Bean方法级别</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@Profile(&quot;环境名&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">a</span><span class="params">()</span>&#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>@Configuration类级别</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Profile(&quot;环境名&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">b</span>&#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="外部化配置"><a href="#外部化配置" class="headerlink" title="外部化配置"></a>外部化配置</h1><h2 id="为什么用外部化配置"><a href="#为什么用外部化配置" class="headerlink" title="为什么用外部化配置"></a>为什么用外部化配置</h2><p>当我们在线上环境的时候，我们已经将程序打包成.jar文件，当我们需要修改一下配置文件的时候，需要修改完后重新打包.这样很麻烦，所以我们引入外部化配置来简化这个修改.</p>
<h3 id="外部化配置方式"><a href="#外部化配置方式" class="headerlink" title="外部化配置方式"></a>外部化配置方式</h3><ul>
<li>properties文件</li>
<li>yaml文件</li>
<li>环境变量</li>
<li>命令行参数</li>
</ul>
<h2 id="外部化配置操作"><a href="#外部化配置操作" class="headerlink" title="外部化配置操作"></a>外部化配置操作</h2><h3 id="加载优先顺序"><a href="#加载优先顺序" class="headerlink" title="加载优先顺序"></a>加载优先顺序</h3><ol>
<li><p>命令行参数</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar jar包.jar --spring.profiles.active=&#123;profile&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在jar包之外(和jar包同级文件)的 application-{profile}.properties或yaml</p>
</li>
<li><p>在jar包中的 application-{profile}.properties或yaml</p>
</li>
<li><p>在jar包之外(和jar包同级文件)的 application.properties或yaml</p>
</li>
<li><p>在jar包中的 application.properties或yaml</p>
</li>
</ol>
<h5 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h5><ul>
<li>jar包之外的application-dev.yaml</li>
<li>用压缩包打开jar包，可以看到jar包中的application-dev.yaml</li>
</ul>
<p><img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-28_180324-16433642299091.png" alt="屏幕截图 2022-01-28 180324"></p>
<h1 id="SpirngBoot整合Mybatis"><a href="#SpirngBoot整合Mybatis" class="headerlink" title="SpirngBoot整合Mybatis"></a>SpirngBoot整合Mybatis</h1><h2 id="引入依赖-1"><a href="#引入依赖-1" class="headerlink" title="引入依赖"></a>引入依赖</h2><ul>
<li>mysql依赖</li>
<li>mybatis依赖</li>
<li>web依赖</li>
<li>test依赖</li>
<li>lombok小插件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="设置apllicationContext和添加配置文件"><a href="#设置apllicationContext和添加配置文件" class="headerlink" title="设置apllicationContext和添加配置文件"></a>设置apllicationContext和添加配置文件</h2><h3 id="配置applicationContext-yaml"><a href="#配置applicationContext-yaml" class="headerlink" title="配置applicationContext.yaml"></a>配置applicationContext.yaml</h3><ul>
<li>配置数据库连接<ul>
<li>username</li>
<li>password</li>
<li>driver-class-name</li>
<li>url</li>
</ul>
</li>
<li>指定mapper映射文件路径：mapper-locations</li>
<li>指定mybatis配置文件路径：config-location</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">用户名</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">用户密码</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/数据库名?useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath:/mapper/*.xml</span></span><br><span class="line">  <span class="attr">config-location:</span> <span class="string">classpath:/mybatis-config.xml</span></span><br></pre></td></tr></table></figure>



<h3 id="添加配置文件"><a href="#添加配置文件" class="headerlink" title="添加配置文件"></a>添加配置文件</h3><p>在Resource文件中添加：</p>
<ul>
<li><p>mapper文件夹</p>
</li>
<li><p>mybatis-config.xml文件</p>
<ul>
<li><p>配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<p><img src="/Liust1918.githud.io/image/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE_2022-01-29_122259.png" alt="屏幕截图 2022-01-29 122259"></p>
<h2 id="XML开发"><a href="#XML开发" class="headerlink" title="XML开发"></a>XML开发</h2><h3 id="添加Entity对象"><a href="#添加Entity对象" class="headerlink" title="添加Entity对象"></a>添加Entity对象</h3><ul>
<li>私有变量</li>
<li>getset</li>
<li>有&#x2F;无构造方法</li>
<li><strong>名字要满足驼峰命名法(否则无法映射,  例如：user_name 要改成userName)</strong></li>
</ul>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer empno;</span><br><span class="line">    <span class="keyword">private</span> String ename;</span><br><span class="line">    <span class="keyword">private</span> String job;</span><br><span class="line">    <span class="keyword">private</span> Date hiredate;</span><br><span class="line">    <span class="keyword">private</span> Float sal;</span><br><span class="line">    <span class="keyword">private</span> Integer deptno;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="添加对应Mapper接口"><a href="#添加对应Mapper接口" class="headerlink" title="添加对应Mapper接口"></a>添加对应Mapper接口</h3><p>创建对应接口</p>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">EmployeeMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;Employee&gt; <span class="title function_">selectAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insert</span><span class="params">(Employee employee)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(Employee employee)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">delete</span><span class="params">(Integer empno)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="添加对应mapper-xml文件"><a href="#添加对应mapper-xml文件" class="headerlink" title="添加对应mapper.xml文件"></a>添加对应mapper.xml文件</h3><ul>
<li><p><strong>namespace</strong>：指向Mapper接口类</p>
</li>
<li><p>增删改查</p>
<ul>
<li><p><strong>id</strong>：指向接口类中的方法名</p>
</li>
<li><p><strong>resultType</strong>：返回结果类</p>
</li>
<li><p><strong>parameterType</strong>：输入参数类</p>
</li>
</ul>
</li>
<li><p><strong>sql输入参数位</strong></p>
<ul>
<li>#{属性名}：预编译(防sql注入)</li>
<li>${属性名}：字符串拼接(最好别用)</li>
</ul>
</li>
<li><p>参数传入</p>
<ul>
<li><p>单个参数：默认加入即可</p>
</li>
<li><p>多个参数：<strong>使用Map和@Param(“别名”)</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义SQL分页查询</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> page  第一个对象固定为分页对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> param 第二个参数Map向SQL传递多参数，但需要使用<span class="doctag">@Param</span>(&quot;sql中的前置名&quot;)定义前置</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 返回分页结果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> IPage&lt;Map&gt; <span class="title function_">selectMap</span><span class="params">(IPage page, <span class="meta">@Param(&quot;p&quot;)</span> Map param)</span>;</span><br><span class="line"><span class="comment">//xml文件中的sql  </span></span><br><span class="line"><span class="comment">/*&lt;select id=&quot;selectMap&quot; parameterType=&quot;java.util.Map&quot; resultType=&quot;java.util.LinkedHashMap&quot;&gt;</span></span><br><span class="line"><span class="comment">        select d.*,g.title</span></span><br><span class="line"><span class="comment">        from</span></span><br><span class="line"><span class="comment">        t_goods_detail d,t_goods g</span></span><br><span class="line"><span class="comment">        where</span></span><br><span class="line"><span class="comment">        d.goods_id = g.goods_id</span></span><br><span class="line"><span class="comment">        and d.gd_order= #&#123;p.order&#125;</span></span><br><span class="line"><span class="comment">        and d.goods_id=#&#123;p.goodsId&#125;  </span></span><br><span class="line"><span class="comment">&lt;/select&gt;</span></span><br><span class="line"><span class="comment">*/</span> </span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<p>例子</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.example.myspringbootmybatis.mapper.EmployeeMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectAll&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.example.myspringbootmybatis.Entity.Employee&quot;</span>&gt;</span></span><br><span class="line">        select *</span><br><span class="line">        from emp</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insert&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.example.myspringbootmybatis.Entity.Employee&quot;</span>&gt;</span></span><br><span class="line">        INSERT INTO `scott`.`emp`(`empno`, `ename`, `job`, `hiredate`, `sal`, `deptno`)</span><br><span class="line">        VALUES (#&#123;empno&#125;, #&#123;ename&#125;, #&#123;job&#125;, #&#123;hiredate&#125;, #&#123;sal&#125;, #&#123;deptno&#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;update&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.example.myspringbootmybatis.Entity.Employee&quot;</span>&gt;</span></span><br><span class="line">        UPDATE `scott`.`emp`</span><br><span class="line">        SET `ename`    = #&#123;ename&#125;,</span><br><span class="line">            `job`      = #&#123;job&#125;,</span><br><span class="line">            `hiredate` = #&#123;hiredate&#125;,</span><br><span class="line">            `sal`      = #&#123;sal&#125;,</span><br><span class="line">            `deptno`   = #&#123;deptno&#125;</span><br><span class="line">        WHERE `empno` = #&#123;empno&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;delete&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.example.myspringbootmybatis.Entity.Employee&quot;</span>&gt;</span></span><br><span class="line">        delete from emp where empno=#&#123;value&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="单元测试-1"><a href="#单元测试-1" class="headerlink" title="单元测试"></a>单元测试</h3><ul>
<li>通过 <strong>@Resource</strong>从IOC容器中获得</li>
</ul>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EmployeeMapperTestor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> EmployeeMapper employeeMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSelect</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Employee&gt; employees = employeeMapper.selectAll();</span><br><span class="line">        employees.stream().forEach(System.out::println);</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="全注解开发"><a href="#全注解开发" class="headerlink" title="全注解开发"></a>全注解开发</h2><h3 id="创建对应的Mapper接口类"><a href="#创建对应的Mapper接口类" class="headerlink" title="创建对应的Mapper接口类"></a>创建对应的Mapper接口类</h3><ul>
<li>给<strong>类</strong>添加 <strong>@Mapper</strong></li>
<li>给<strong>方法</strong>添加对应增删改查注解<ul>
<li>@Select(sql语句)</li>
<li>@Insert(sql语句)</li>
<li>@Delete(sql语句)</li>
<li>@Update(sql语句)<ul>
<li>sql语句添加参数：**#{属性名}**</li>
</ul>
</li>
</ul>
</li>
<li>利用@Resource从IOC容器拉取</li>
</ul>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DepartmentMapper</span> &#123;</span><br><span class="line">    <span class="meta">@Select(&quot;select * from dept order by dname&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Department&gt; <span class="title function_">selectAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Insert(&quot;INSERT INTO `scott`.`dept`(`deptno`, `dname`, `loc`) VALUES (#&#123;deptno&#125;, #&#123;dname&#125;, #&#123;loc&#125;)&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">insert</span><span class="params">(Department department)</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="声明型事务管理"><a href="#声明型事务管理" class="headerlink" title="声明型事务管理"></a>声明型事务管理</h2><h3 id="为什么要事务管理"><a href="#为什么要事务管理" class="headerlink" title="为什么要事务管理"></a>为什么要事务管理</h3><p>当我们批量增删改提交到数据库的时候，其中某条数据发送异常错误，但是在这一批中，前面的已经提交了，后面的因为前面那个异常就不提交了，这样很不好，我们希望要不全提交，要不全不提交.那么就可以使用事务管理.</p>
<h3 id="操作事务"><a href="#操作事务" class="headerlink" title="操作事务"></a>操作事务</h3><h4 id="事务原理"><a href="#事务原理" class="headerlink" title="事务原理"></a>事务原理</h4><p>使用Spring声明式事务，当我们提交事务时候：</p>
<ul>
<li>发送异常(<strong>默认RuntimeException异常及其子类异常，或者配置的指定异常类</strong>)，<strong>回滚事务</strong></li>
<li>不发生异常(或者配置的指定异常类)，提交事务</li>
</ul>
<h4 id="Transactional"><a href="#Transactional" class="headerlink" title="@Transactional"></a>@Transactional</h4><h5 id="使用级别"><a href="#使用级别" class="headerlink" title="使用级别"></a>使用级别</h5><p>@Transactional可以在类或者方法是使用</p>
<ul>
<li>类级别：下面的方法都事务管理</li>
<li>方法级别：只用本方法事务管理</li>
<li><strong>类级别的注解重载方法级别的注解</strong></li>
</ul>
<h5 id="注解属性-不完全"><a href="#注解属性-不完全" class="headerlink" title="注解属性(不完全)"></a>注解属性(不完全)</h5><table>
<thead>
<tr>
<th>属性项</th>
<th>含义</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>propagation</td>
<td>传播行为</td>
<td>传播行为是方法直接调用的问题.默认值为Propagation.REQUIRED</td>
</tr>
<tr>
<td>timeout</td>
<td>超时时间</td>
<td>单位为s，超时就事务回滚</td>
</tr>
<tr>
<td>readOnly</td>
<td>是否开启只读</td>
<td>默认false</td>
</tr>
<tr>
<td>rollbackFor</td>
<td>回滚事务的异常类指定(最好指定Exception.class)</td>
<td>只用当方法产生这里指定的异常时，才会回滚事务.</td>
</tr>
<tr>
<td>rollbackForClassName</td>
<td>回滚事务的异常类名指定</td>
<td>同上，但是用异常类的名指定</td>
</tr>
<tr>
<td>noRollbackFor</td>
<td>当产生哪些异常不回滚事务</td>
<td>同上，但是相反</td>
</tr>
<tr>
<td>noRollbackForClassName</td>
<td>同上</td>
<td>同上，但是用异常类的名指定</td>
</tr>
</tbody></table>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul>
<li>大型项目多人写作采用XML配置有更好维护性</li>
<li>小型敏捷开发项目用注解拥有更好的开发体验</li>
<li>注解开发适用在继承表&#x2F;字典等明确不需要复杂SQL的场景</li>
<li>当出现多条件动态查询时，建议使用XML形式配置.</li>
</ul>
<h1 id="SpirngBoot整合Mybatis-plus"><a href="#SpirngBoot整合Mybatis-plus" class="headerlink" title="SpirngBoot整合Mybatis-plus"></a>SpirngBoot整合Mybatis-plus</h1><h2 id="引入Mybaits-plus"><a href="#引入Mybaits-plus" class="headerlink" title="引入Mybaits-plus"></a>引入Mybaits-plus</h2><h4 id="添加依赖-4"><a href="#添加依赖-4" class="headerlink" title="添加依赖"></a>添加依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="添加扫描接口"><a href="#添加扫描接口" class="headerlink" title="添加扫描接口"></a>添加扫描接口</h4><ul>
<li>在主启动类添加 <strong>@MapperScan(“接口路径”)</strong></li>
</ul>
<p>例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.example.myspringbootmybatis.mapper&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MySpringBootMybatisApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(MySpringBootMybatisApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="给Entity添加注解"><a href="#给Entity添加注解" class="headerlink" title="给Entity添加注解"></a>给Entity添加注解</h4><p>要个Entity类找到对应的数据库和字段，添加以下注解:</p>
<ul>
<li>@<strong>TableName</strong>(“对应表名”)</li>
<li>@<strong>TableId</strong>(id生成策略)<ul>
<li><strong>type &#x3D; IdType.AUTO</strong></li>
</ul>
</li>
<li>@<strong>TableField</strong>(“数据库字段”)</li>
</ul>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@TableName(&quot;salgrade&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Mysalrade</span> &#123;</span><br><span class="line">    <span class="meta">@TableId(type = IdType.AUTO)</span></span><br><span class="line">    <span class="meta">@TableField(&quot;grade&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer grade;</span><br><span class="line">    <span class="meta">@TableField(&quot;losal&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer lostSal;</span><br><span class="line">    <span class="meta">@TableField(&quot;hisal&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer highSal;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="创建Mapper接口"><a href="#创建Mapper接口" class="headerlink" title="创建Mapper接口"></a>创建Mapper接口</h4><p>创建对应接口类，并且**继承BaseMapper&lt;对应Entity类&gt;**，里面默认写了简单的增删查改方法，可以方便我们使用.并且加载到IOC容器中</p>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MysalradeMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;Mysalrade&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> IPage&lt;Mysalrade&gt; <span class="title function_">selectAllofPage</span><span class="params">(IPage&lt;Mysalrade&gt; iPage)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="添加对应XML文件-可选"><a href="#添加对应XML文件-可选" class="headerlink" title="添加对应XML文件(可选)"></a>添加对应XML文件(可选)</h4><p>当我们的需求已经没有办法满足BaseMapper提供的方法的时候，我们可以像之前的mybatis一样，使用对应xml文件来写sql.</p>
<h4 id="简单操作增删改查语句"><a href="#简单操作增删改查语句" class="headerlink" title="简单操作增删改查语句"></a>简单操作增删改查语句</h4><p>内置基本的增删改查的基本sql方法，以一下开头：</p>
<ul>
<li>selectXXX</li>
<li>deleteXXX</li>
<li>insert</li>
<li>updateXXX</li>
</ul>
<p>简单测试例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">salgradeMapperTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> MysalradeMapper salgradeMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testOnlySelect</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Mysalrade</span> <span class="variable">mysalrade</span> <span class="operator">=</span> salgradeMapper.selectById(<span class="number">1</span>);</span><br><span class="line">        System.out.println(mysalrade.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="查询构造器"><a href="#查询构造器" class="headerlink" title="查询构造器"></a>查询构造器</h2><p>查询构造器相当于我们在原来BaseMapper提供的基本语句中，通过java代码的方式，再添加其他条件sql语句.</p>
<h3 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h3><ul>
<li>创建QueryWrapper类</li>
<li>调用里面的对应sql方法</li>
<li>作为参数添加到原本查&#x2F;删&#x2F;改&#x2F;插的语句</li>
</ul>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">salgradeMapperTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> MysalradeMapper salgradeMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testQueryWrapper</span><span class="params">()</span>&#123;</span><br><span class="line">        QueryWrapper&lt;Mysalrade&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.ge(<span class="string">&quot;hisal&quot;</span>,<span class="number">1000</span>);</span><br><span class="line">        wrapper.le(<span class="string">&quot;hisal&quot;</span>,<span class="number">5000</span>);</span><br><span class="line">     <span class="comment">//原来: SELECT grade,losal AS lostSal,hisal AS highSal FROM salgrade </span></span><br><span class="line">     <span class="comment">//添加查询构造器后：</span></span><br><span class="line">     <span class="comment">//SELECT grade,losal AS lostSal,hisal AS highSal FROM salgrade WHERE (hisal &gt;= 1000 AND hisal &lt;= 1500)</span></span><br><span class="line">        List&lt;Mysalrade&gt; mysalrades = salgradeMapper.selectList(wrapper);</span><br><span class="line">        mysalrades.stream().forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="更好用的查询构造器LambdaQueryWrapper"><a href="#更好用的查询构造器LambdaQueryWrapper" class="headerlink" title="更好用的查询构造器LambdaQueryWrapper"></a>更好用的查询构造器LambdaQueryWrapper</h3><ul>
<li>在原来QueryWrapper类上</li>
<li>可以使用<strong>java8的Lambda表达式</strong></li>
<li><strong>大大减低写错列名的问题</strong></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wrapper.xxx(类名::getXXX,输入值)</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">salgradeMapperTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> MysalradeMapper salgradeMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testQueryWrapper</span><span class="params">()</span>&#123;</span><br><span class="line">        QueryWrapper&lt;Mysalrade&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.ge(Mysalrade::getHisal,<span class="number">1000</span>);</span><br><span class="line">        wrapper.le(Mysalrade::getHisal,<span class="number">5000</span>);</span><br><span class="line">     <span class="comment">//原来: SELECT grade,losal AS lostSal,hisal AS highSal FROM salgrade </span></span><br><span class="line">     <span class="comment">//添加查询构造器后：</span></span><br><span class="line">     <span class="comment">//SELECT grade,losal AS lostSal,hisal AS highSal FROM salgrade WHERE (hisal &gt;= 1000 AND hisal &lt;= 1500)</span></span><br><span class="line">        List&lt;Mysalrade&gt; mysalrades = salgradeMapper.selectList(wrapper);</span><br><span class="line">        mysalrades.stream().forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="常用查询构造器"><a href="#常用查询构造器" class="headerlink" title="常用查询构造器"></a>常用查询构造器</h3><p>文档：<a target="_blank" rel="noopener" href="https://baomidou.com/pages/10c804/#abstractwrapper">https://baomidou.com/pages/10c804/#abstractwrapper</a></p>
<table>
<thead>
<tr>
<th>方法名</th>
<th>作用</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>allEq</td>
<td>全部字段都等于</td>
<td>默认可以空，添加false关闭</td>
</tr>
<tr>
<td>eq</td>
<td>&#x3D;</td>
<td></td>
</tr>
<tr>
<td>ne</td>
<td>&lt;&gt;</td>
<td></td>
</tr>
<tr>
<td>gt</td>
<td>&gt;</td>
<td></td>
</tr>
<tr>
<td>ge</td>
<td>&gt;&#x3D;</td>
<td></td>
</tr>
<tr>
<td>lt</td>
<td>&lt;</td>
<td></td>
</tr>
<tr>
<td>le</td>
<td>&lt;&#x3D;</td>
<td></td>
</tr>
<tr>
<td>between</td>
<td>between and</td>
<td></td>
</tr>
<tr>
<td>notBetween</td>
<td>not between and</td>
<td></td>
</tr>
<tr>
<td>like</td>
<td>like ‘%值%’</td>
<td></td>
</tr>
<tr>
<td>notLike</td>
<td>not like ‘%值%’</td>
<td></td>
</tr>
<tr>
<td>likeLeft</td>
<td>like ‘%值’</td>
<td></td>
</tr>
<tr>
<td>likeRight</td>
<td>like ‘值%’</td>
<td></td>
</tr>
<tr>
<td>isNull</td>
<td>is null</td>
<td></td>
</tr>
<tr>
<td>isNotNull</td>
<td>is not null</td>
<td></td>
</tr>
<tr>
<td>in</td>
<td>in( ..)</td>
<td></td>
</tr>
<tr>
<td>notIn</td>
<td>not in( ..)</td>
<td></td>
</tr>
<tr>
<td>isSql</td>
<td>in(sql语句)</td>
<td></td>
</tr>
<tr>
<td>notInSql</td>
<td>not in(sql语句)</td>
<td></td>
</tr>
<tr>
<td>groupBy</td>
<td>Group By 字段</td>
<td></td>
</tr>
<tr>
<td>orderByAsc</td>
<td>ORDER BY 字段, … ASC</td>
<td></td>
</tr>
<tr>
<td>orderByDesc</td>
<td>ORDER BY 字段, … DESC</td>
<td></td>
</tr>
<tr>
<td>orderBy</td>
<td>ORDER BY 字段</td>
<td></td>
</tr>
<tr>
<td>having</td>
<td>HAVING ( sql语句 )</td>
<td></td>
</tr>
<tr>
<td>or</td>
<td>or</td>
<td>不调用or(),其他默认为and</td>
</tr>
<tr>
<td>and</td>
<td>and</td>
<td></td>
</tr>
<tr>
<td>exists</td>
<td>EXISTS ( sql语句 )</td>
<td></td>
</tr>
</tbody></table>
<h2 id="分页插件"><a href="#分页插件" class="headerlink" title="分页插件"></a>分页插件</h2><h2 id="一般分页（mysql为例）"><a href="#一般分页（mysql为例）" class="headerlink" title="一般分页（mysql为例）"></a>一般分页（mysql为例）</h2><p>以往的分页步骤，如下：</p>
<ol>
<li><p>执行分页语句,获取当前页数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from tab limit 0,10 </span><br></pre></td></tr></table></figure>
</li>
<li><p>获取在不分页情况下的数据总数,用来计算总页数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*) from tab </span><br></pre></td></tr></table></figure></li>
</ol>
<p>以往这个过程费时费力,但在引入MyBatis-plus分页插件后就成为过去</p>
<h3 id="配置分页插件"><a href="#配置分页插件" class="headerlink" title="配置分页插件"></a>配置分页插件</h3><ol>
<li><p>在主启动类添加自定义bean</p>
</li>
<li><p><strong>MybatisPlusInterceptor</strong>拦截器用于拦截MyBatis中SQL的执 </p>
<p>行,自动生成 select count(*) 语句</p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">MybatisPlusInterceptor</span> <span class="variable">mybatisPlusInterceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">    <span class="comment">//给拦截器添加 PaginationInner拦截器 并且指定Mysql数据库的分页方式</span></span><br><span class="line">    mybatisPlusInterceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>(DbType.MYSQL));</span><br><span class="line">    <span class="keyword">return</span> mybatisPlusInterceptor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="操作分页插件"><a href="#操作分页插件" class="headerlink" title="操作分页插件"></a>操作分页插件</h3><h4 id="继承BaseMapper"><a href="#继承BaseMapper" class="headerlink" title="继承BaseMapper"></a>继承BaseMapper</h4><ul>
<li><p>创建<strong>Page&lt;Entity类&gt;对象(第几页数，每页总数)</strong></p>
</li>
<li><p>作为参数添加到方法中</p>
</li>
<li><p>返回<strong>IPage对象</strong></p>
<ul>
<li><table>
<thead>
<tr>
<th>方法名</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>getPages()</td>
<td>总页数</td>
</tr>
<tr>
<td>getSIze()</td>
<td>每页大小</td>
</tr>
<tr>
<td>getTotal()</td>
<td>查询条数</td>
</tr>
<tr>
<td>getRecords()</td>
<td>具体数据</td>
</tr>
<tr>
<td>getCurrent()</td>
<td>当前页数</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
</ul>
<p>分页例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">salgradeMapperTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> MysalradeMapper salgradeMapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">TestPage</span><span class="params">()</span>&#123;</span><br><span class="line">        IPage&lt;Mysalrade&gt; iPage = <span class="keyword">new</span> <span class="title class_">Page</span>(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line">        QueryWrapper&lt;Mysalrade&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        iPage= salgradeMapper.selectPage(iPage, queryWrapper);</span><br><span class="line">        </span><br><span class="line">        iPage.getRecords().stream().forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="自定义分页"><a href="#自定义分页" class="headerlink" title="自定义分页"></a>自定义分页</h4><p>当基本的sql语句满足不了我们，需要更加复杂的sql语句时候，并且需要分页时候，可以使用XML方式.</p>
<ol>
<li>在Mapper接口添加对应方法<ul>
<li>IPage&lt;Entity类&gt;对象作为参数添加</li>
<li>返回IPage&lt;Entity类&gt;对象</li>
</ul>
</li>
<li>创建对应xml文件</li>
<li>操作并填入IPage对象<ul>
<li><strong>不用额外填写parameterType</strong></li>
<li>resultType返回Entity类即可</li>
</ul>
</li>
</ol>
<p>例子</p>
<ol>
<li><p>MysalradeMapper类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MysalradeMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;Mysalrade&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> IPage&lt;Mysalrade&gt; <span class="title function_">selectAllofPage</span><span class="params">(IPage&lt;Mysalrade&gt; iPage)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>对应xml文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span></span></span><br><span class="line"><span class="meta">        <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.example.myspringbootmybatis.mapper.MysalradeMapper&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectAllofPage&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.example.myspringbootmybatis.Entity.Mysalrade&quot;</span> &gt;</span></span><br><span class="line">       select grade,losal as lostSal,hisal as highSal from salgrade</span><br><span class="line">   <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>调用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMyXMLPage</span><span class="params">()</span>&#123;</span><br><span class="line">     IPage&lt;Mysalrade&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line">     page= salgradeMapper.selectAllofPage(page);</span><br><span class="line">     page.getRecords().stream().forEach(System.out::println);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="解决字段对应问题"><a href="#解决字段对应问题" class="headerlink" title="解决字段对应问题"></a>解决字段对应问题</h3><ul>
<li><p>直接在XML文件上修改sql，添加别称</p>
</li>
<li><p>添加mybatis配置驼峰命名法设置（例如:first_name -&gt; firstName）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;mapUnderscoreToCamelCase&quot;</span> <span class="attr">value</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="Druid连接池"><a href="#Druid连接池" class="headerlink" title="Druid连接池"></a>Druid连接池</h1><h2 id="为什么要连接池"><a href="#为什么要连接池" class="headerlink" title="为什么要连接池"></a>为什么要连接池</h2><p>连接池是一种以时间换时间的技术，用程序加载时间的增加来换取执行时间的下降.</p>
<p>每次程序连接数据库都会执行底层TCP&#x2F;IP协议，会消耗多的资源，当我们预先加载一些连接，等程序连接时候直接使用，这样可以提供执行效率.并且增加了拓展性.</p>
<h2 id="为什么选择Druid"><a href="#为什么选择Druid" class="headerlink" title="为什么选择Druid"></a>为什么选择Druid</h2><p>常见的连接池技术：</p>
<ul>
<li>dpcp</li>
<li>dpcp2</li>
<li>tomcat</li>
<li>hikari</li>
<li>Druid</li>
</ul>
<p>当使用tomcat的时候，默认使用tomcat连接池.</p>
<p>如果脱离web，那就是hikari，但是这个没有监控.</p>
<p>Druid优点:</p>
<ol>
<li><strong>java语言中最好的数据库连接池</strong></li>
<li><strong>强大的监控和拓展功能</strong></li>
</ol>
<h2 id="配置Druid连接池和监控"><a href="#配置Druid连接池和监控" class="headerlink" title="配置Druid连接池和监控"></a>配置Druid连接池和监控</h2><h2 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h2><h4 id="引入依赖-2"><a href="#引入依赖-2" class="headerlink" title="引入依赖"></a>引入依赖</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>druid-spring-boot-starter是阿里巴巴官方提供的Druid Starter</li>
<li>spring-boot-starter-aop依赖AOP来开启Druid String监控</li>
</ul>
<h4 id="配置Druid连接池和监控项"><a href="#配置Druid连接池和监控项" class="headerlink" title="配置Druid连接池和监控项"></a>配置Druid连接池和监控项</h4><p>在application.yaml中添加如下:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">druid:</span></span><br><span class="line"><span class="comment">#     初始创建连接数</span></span><br><span class="line">      <span class="attr">initial-size:</span> <span class="number">20</span></span><br><span class="line"><span class="comment">#      最大连接数(一般取最高并发量的1.2-1.3倍)</span></span><br><span class="line">      <span class="attr">max-active:</span> <span class="number">20</span></span><br><span class="line"><span class="comment">#      开启URI监控和Session监控</span></span><br><span class="line">      <span class="attr">web-stat-filter:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment">#        启动访问后台</span></span><br><span class="line">      <span class="attr">stat-view-servlet:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment">#        后台用户名和密码</span></span><br><span class="line">        <span class="attr">login-username:</span> <span class="string">root</span></span><br><span class="line">        <span class="attr">login-password:</span> <span class="string">root</span></span><br><span class="line"><span class="comment">#        颗粒度更细的过滤器</span></span><br><span class="line">      <span class="attr">filter:</span></span><br><span class="line"><span class="comment">#        开启SQL监控</span></span><br><span class="line">        <span class="attr">stat:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment">#          启动sql合并</span></span><br><span class="line">          <span class="attr">merge-sql:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment">#          启动慢sql信息收集</span></span><br><span class="line">          <span class="attr">log-slow-sql:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment">#          超过1秒记录为慢sql</span></span><br><span class="line">          <span class="attr">slow-sql-millis:</span> <span class="number">1000</span></span><br><span class="line"><span class="comment">#          启动sql防火墙</span></span><br><span class="line">        <span class="attr">wall:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment">##          启动日志输出</span></span><br><span class="line">        <span class="attr">slf4j:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment">#          开启Spring监控</span></span><br><span class="line">      <span class="attr">aop-patterns:</span> <span class="string">com.example.myspringbootmybatis.Controller.*</span></span><br></pre></td></tr></table></figure>

<h4 id="启动Spring-Boot"><a href="#启动Spring-Boot" class="headerlink" title="启动Spring Boot"></a>启动Spring Boot</h4><p>启动服务后，访问地址:<a target="_blank" rel="noopener" href="http://localhost:8081/druid">http://localhost:8081/druid</a></p>
<ul>
<li><strong>SQL监控</strong>：从数据库层面监控</li>
<li><strong>SQL防火墙</strong>:控制黑白名单sql，防止sql注入</li>
<li><strong>Web应用</strong>：从Web层面获得大概数据</li>
<li><strong>URI监控</strong>:基于地址层面监控</li>
<li><strong>Session监控</strong>：基于tomcat的会话层面监控</li>
<li><strong>Spring监控</strong>：从方法层面监控IoC容器内的方法访问情况</li>
</ul>
<h2 id="其他可用配置选项"><a href="#其他可用配置选项" class="headerlink" title="其他可用配置选项"></a>其他可用配置选项</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据库类型为mysql </span></span><br><span class="line"><span class="attr">spring.datasource.dbType</span>=<span class="string">mysql </span></span><br><span class="line"><span class="comment">#启动时初始化5个连接 </span></span><br><span class="line"><span class="attr">spring.datasource.initialSize</span>=<span class="string">20 </span></span><br><span class="line"><span class="comment">#最小空闲连接5个</span></span><br><span class="line"><span class="attr">spring.datasource.minIdle</span>=<span class="string">5</span></span><br><span class="line"><span class="comment">#最大连接数量20 </span></span><br><span class="line"><span class="attr">spring.datasource.maxActive</span>=<span class="string">20 </span></span><br><span class="line"><span class="comment">#获取连接等待时间60秒，超出报错</span></span><br><span class="line"><span class="attr">spring.datasource.maxWait</span>=<span class="string">60000 </span></span><br><span class="line"><span class="comment"> #每60秒执行一次连接回收器 </span></span><br><span class="line"><span class="attr">spring.datasource.timeBetweenEvictionRunsMillis</span>=<span class="string">60000 </span></span><br><span class="line"><span class="comment">#5分钟内没有任何操作的空闲连接会被回收 </span></span><br><span class="line"><span class="attr">spring.datasource.minEvictableIdleTimeMillis</span>=<span class="string">300000 </span></span><br><span class="line"><span class="comment">#验证连接有效性的SQL </span></span><br><span class="line"><span class="attr">spring.datasource.validationQuery</span>=<span class="string">select &#x27;x&#x27; </span></span><br><span class="line"><span class="comment">#空闲时校验，建议开启 </span></span><br><span class="line"><span class="attr">spring.datasource.testWhileIdle</span>=<span class="string">true </span></span><br><span class="line"><span class="comment">#使用中是否校验有效性，推荐关闭 </span></span><br><span class="line"><span class="attr">spring.datasource.testOnBorrow</span>=<span class="string">false </span></span><br><span class="line"><span class="comment">#归还连接时校验有效性，推荐关闭 </span></span><br><span class="line"><span class="attr">spring.datasource.testOnReturn</span>=<span class="string">false </span></span><br><span class="line"><span class="attr">spring.datasource.poolPreparedStatements</span>=<span class="string">false </span></span><br><span class="line"><span class="comment">#设置过滤器，stat用于接收状态，wall用于防止SQL注入,slf4j则说明使用logback日志输出 </span></span><br><span class="line"><span class="attr">spring.datasource.filters</span>=<span class="string">stat,wall,slf4j </span></span><br><span class="line"><span class="comment">#统计所有数据源状态 </span></span><br><span class="line"><span class="attr">spring.datasource.useGlobalDataSourceStat</span>=<span class="string">true </span></span><br><span class="line"><span class="comment">#sql合并统计，与设置慢SQL时间为500毫秒 </span></span><br><span class="line"><span class="attr">spring.datasource.connectionProperties</span>=<span class="string">druid.stat.mergeSql=true;druid.stat.slow SqlMillis=500</span></span><br></pre></td></tr></table></figure>





<h1 id="封装自定义的start包"><a href="#封装自定义的start包" class="headerlink" title="封装自定义的start包"></a>封装自定义的start包</h1><h2 id="start包是什么"><a href="#start包是什么" class="headerlink" title="start包是什么"></a>start包是什么</h2><p>我们在springBoot平时引用依赖的时候，会遇到不同的spring-boot-start包，他们有两种类型：</p>
<ul>
<li>spring-boot-start-XXX：一般为收录到官方的包</li>
<li>XXX-spring-boot-start：一般为第三方的包</li>
</ul>
<h2 id="封装start包"><a href="#封装start包" class="headerlink" title="封装start包"></a>封装start包</h2><h3 id="开发业务逻辑接口与实现类"><a href="#开发业务逻辑接口与实现类" class="headerlink" title="开发业务逻辑接口与实现类"></a>开发业务逻辑接口与实现类</h3><ul>
<li>开发接口</li>
<li>实现类</li>
</ul>
<p>以下例子：</p>
<ul>
<li><p>接口Digest</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Digest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">digest</span><span class="params">(String s)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>实现类Md5Digest</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Md5Digest</span> <span class="keyword">implements</span> <span class="title class_">Digest</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">digest</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;使用MD5算法生成摘要&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> DigestUtils.md5Hex(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>实现类ShaDigest</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShaDigest</span> <span class="keyword">implements</span> <span class="title class_">Digest</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">digest</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;使用Sha256算法生成摘要&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> DigestUtils.sha256Hex(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="开发加载配置用的Setting类"><a href="#开发加载配置用的Setting类" class="headerlink" title="开发加载配置用的Setting类"></a>开发加载配置用的Setting类</h3><ul>
<li>@Component</li>
<li>ConfigurationProperties(prefix&#x3D;”前缀”)</li>
</ul>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载配置信息</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;digest&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Setting</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String type;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setType</span><span class="params">(String type)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.type = type;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>配置在application.properties</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">digest.type=md5</span></span><br></pre></td></tr></table></figure>



<h3 id="配置类Config"><a href="#配置类Config" class="headerlink" title="配置类Config"></a>配置类Config</h3><h5 id="配置注解"><a href="#配置注解" class="headerlink" title="配置注解"></a>配置注解</h5><ul>
<li><strong>@Configuration</strong>定义配置类</li>
<li><strong>@EnableConfigurationProperties(Setting.class)</strong> 加载设置选项</li>
<li><strong>@Bean</strong> 创建对象<ul>
<li>方法名为beanId</li>
<li>返回值为class</li>
</ul>
</li>
<li><strong>@ConditionalOnProperty</strong> 条件化加载，相当于if判断，满足条件就会执行方法创建对象<ul>
<li>prefix：前缀</li>
<li>name：属性名</li>
<li>havingValue：满足的值</li>
</ul>
</li>
</ul>
<p>说明：</p>
<p>以第一个方法为例子，当在application.yaml中出现digest.type的前缀，并且填写的值为md5，就会执行这个方法，创建Md5Digest对象，加载到IoC容器中.</p>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="comment">//激活配置属性</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(Setting.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Config</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnProperty(prefix = &quot;digest&quot;,name = &quot;type&quot;,havingValue = &quot;md5&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Digest <span class="title function_">md5Digest</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Loading Md5Digest object&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Md5Digest</span>();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnProperty(prefix = &quot;digest&quot;,name = &quot;type&quot;,havingValue = &quot;sha&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Digest <span class="title function_">shaDigest</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Loading ShaDigest object&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ShaDigest</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="其他条件化加载的注解"><a href="#其他条件化加载的注解" class="headerlink" title="其他条件化加载的注解"></a>其他条件化加载的注解</h5><ul>
<li><strong>@ConditionalOnBean</strong>：当容器里有指定Bean的条件下</li>
<li><strong>@ConditionalOnClass</strong>：当类路径下有指定类的条件下</li>
<li><strong>@ConditionalOnProperty</strong>：指定的属性是否有指定的值</li>
</ul>
<h3 id="在本项目新建-x2F-resources-x2F-META-INF-x2F-spring-factories"><a href="#在本项目新建-x2F-resources-x2F-META-INF-x2F-spring-factories" class="headerlink" title="在本项目新建&#x2F;resources&#x2F;META-INF&#x2F;spring.factories"></a>在本项目新建&#x2F;resources&#x2F;META-INF&#x2F;spring.factories</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.boot.autoconfigure.EnableAutoConfiguration=配置类路径</span><br></pre></td></tr></table></figure>

<p>在其他工程引用该starter的时候，会自动创建对应的类并实例化对象(<strong>EnableAutoConfiguration</strong>)，这样在目标工程的IoC容器中就会出现对应对象.</p>
<p>例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.boot.autoconfigure.EnableAutoConfiguration=com.liuyulong.digest.conf.Config</span><br></pre></td></tr></table></figure>



<h3 id="屏蔽掉pom-xml的spring-boot-maven-plugin插件"><a href="#屏蔽掉pom-xml的spring-boot-maven-plugin插件" class="headerlink" title="屏蔽掉pom.xml的spring-boot-maven-plugin插件"></a>屏蔽掉pom.xml的spring-boot-maven-plugin插件</h3><ul>
<li>Spring Boot默认创建FatJar</li>
<li>通过<strong>屏蔽打包插件来打印标准Jar包</strong></li>
</ul>
<h3 id="通过maven的install将该Starter在本地安装"><a href="#通过maven的install将该Starter在本地安装" class="headerlink" title="通过maven的install将该Starter在本地安装"></a>通过maven的install将该Starter在本地安装</h3><h2 id="使用start包"><a href="#使用start包" class="headerlink" title="使用start包"></a>使用start包</h2><p>想其他依赖引用的方式是用，在pom.xml填写(例子)：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.liuyulong<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>digest-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="在其他项目验证："><a href="#在其他项目验证：" class="headerlink" title="在其他项目验证："></a>在其他项目验证：</h4><ul>
<li><p>application.yml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">digest:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">sha</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>其他引用(因为包注入到IOC容器里面了)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">toTestStartsPackController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(<span class="built_in">this</span>.getClass());</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> Digest digest;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/testStarts/&#123;test&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity <span class="title function_">testStarts</span><span class="params">(<span class="meta">@PathVariable(value = &quot;test&quot;)</span> String s)</span> &#123;</span><br><span class="line">        logger.info(s);</span><br><span class="line">        <span class="type">String</span> <span class="variable">digest</span> <span class="operator">=</span> <span class="built_in">this</span>.digest.digest(s);</span><br><span class="line">        LinkedHashMap&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;加密前&quot;</span>, s);</span><br><span class="line">        map.put(<span class="string">&quot;加密后&quot;</span>, digest);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>(map, HttpStatus.OK);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/Android/"><span class="level-start"><span class="level-item">Android</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/C%E8%AF%AD%E8%A8%80/"><span class="level-start"><span class="level-item">C语言</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/Hexo/"><span class="level-start"><span class="level-item">Hexo</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/LeetCode/"><span class="level-start"><span class="level-item">LeetCode</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/git/"><span class="level-start"><span class="level-item">git</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/java/"><span class="level-start"><span class="level-item">java</span></span><span class="level-end"><span class="level-item tag">4</span></span></a><ul><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/java/java8/"><span class="level-start"><span class="level-item">java8</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/java/%E5%8F%8D%E5%B0%84/"><span class="level-start"><span class="level-item">反射</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/java/%E6%B3%A8%E8%A7%A3/"><span class="level-start"><span class="level-item">注解</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/"><span class="level-start"><span class="level-item">后端</span></span><span class="level-end"><span class="level-item tag">5</span></span></a><ul><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/SSM/"><span class="level-start"><span class="level-item">SSM</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/spring/"><span class="level-start"><span class="level-item">spring</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="level-start"><span class="level-item">数据库</span></span><span class="level-end"><span class="level-item tag">1</span></span></a><ul><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/"><span class="level-start"><span class="level-item">Mysql</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/Liust1918.githud.io/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="level-start"><span class="level-item">设计模式</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/Android/"><span class="tag">Android</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/C/"><span class="tag">C</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/C/"><span class="tag">C++</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/Hexo/"><span class="tag">Hexo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/Hibernate/"><span class="tag">Hibernate</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/LeetCode/"><span class="tag">LeetCode</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/SSM/"><span class="tag">SSM</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/git/"><span class="tag">git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/githud/"><span class="tag">githud</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/java/"><span class="tag">java</span><span class="tag">20</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/java8/"><span class="tag">java8</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/mysql/"><span class="tag">mysql</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/spring/"><span class="tag">spring</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/springboot2/"><span class="tag">springboot2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/%E5%8F%8D%E5%B0%84/"><span class="tag">反射</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/%E5%90%8E%E7%AB%AF/"><span class="tag">后端</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/%E6%8A%80%E6%9C%AF%E4%B9%A6/"><span class="tag">技术书</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/%E6%B3%A8%E8%A7%A3/"><span class="tag">注解</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/%E7%AE%97%E6%B3%95/"><span class="tag">算法</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/Liust1918.githud.io/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="tag">设计模式</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">广告</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="liust" data-ad-slot="1918" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/Liust1918.githud.io/img/Battlerfiled3.jpg" alt="Liust1918"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Liust1918</p><p class="is-size-6 is-block">Web Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Ice Earth</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/Liust1918.githud.io/archives"><p class="title">23</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/Liust1918.githud.io/categories"><p class="title">15</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/Liust1918.githud.io/tags"><p class="title">20</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Liust1918" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Liust1918"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/Liust1918.githud.io/"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://github.com/Liust1918" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Githud</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-03-06T02:44:23.000Z">2023-03-06</time></p><p class="title"><a href="/Liust1918.githud.io/2023/03/06/%E9%87%8D%E5%AD%A6Java8/">重学Java8</a></p><p class="categories"><a href="/Liust1918.githud.io/categories/java/">java</a> / <a href="/Liust1918.githud.io/categories/java/java8/">java8</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-02-22T15:46:48.000Z">2023-02-22</time></p><p class="title"><a href="/Liust1918.githud.io/2023/02/22/java%E6%B3%A8%E8%A7%A3/">java注解</a></p><p class="categories"><a href="/Liust1918.githud.io/categories/java/">java</a> / <a href="/Liust1918.githud.io/categories/java/%E6%B3%A8%E8%A7%A3/">注解</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-02-22T06:04:30.000Z">2023-02-22</time></p><p class="title"><a href="/Liust1918.githud.io/2023/02/22/java%E5%8F%8D%E5%B0%84/">java反射</a></p><p class="categories"><a href="/Liust1918.githud.io/categories/java/">java</a> / <a href="/Liust1918.githud.io/categories/java/%E5%8F%8D%E5%B0%84/">反射</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-12-03T17:11:33.000Z">2022-12-04</time></p><p class="title"><a href="/Liust1918.githud.io/2022/12/04/Mysql%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/">Mysql必知必会书</a></p><p class="categories"><a href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/">后端</a> / <a href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a> / <a href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/">Mysql</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-12-03T16:56:56.000Z">2022-12-04</time></p><p class="title"><a href="/Liust1918.githud.io/2022/12/04/SSM/">SSM</a></p><p class="categories"><a href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/">后端</a> / <a href="/Liust1918.githud.io/categories/%E5%90%8E%E7%AB%AF/SSM/">SSM</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/Liust1918.githud.io/archives/2023/03/"><span class="level-start"><span class="level-item">三月 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/Liust1918.githud.io/archives/2023/02/"><span class="level-start"><span class="level-item">二月 2023</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/Liust1918.githud.io/archives/2022/12/"><span class="level-start"><span class="level-item">十二月 2022</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li></ul></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/Liust1918.githud.io/"><img src="/Liust1918.githud.io/img/Battlerfiled3.jpg" alt="Liust of Blog" height="28"></a><p class="is-size-7"><span>&copy; 2023 Liust</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="My GitHub" href="https://github.com/Liust1918"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/Liust1918.githud.io/js/column.js"></script><script src="/Liust1918.githud.io/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/Liust1918.githud.io/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/Liust1918.githud.io/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/Liust1918.githud.io/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/Liust1918.githud.io/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>